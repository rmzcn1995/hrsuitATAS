<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title> ATA≈û Personel Performans & ƒ∞K Y√∂netimi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f4f5fb;
      --sidebar-bg: #111827;
      --primary: #2563eb;
      --primary-soft: #dbeafe;
      --danger: #ef4444;
      --success: #16a34a;
      --text-main: #111827;
      --text-soft: #6b7280;
      --card-bg: #ffffff;
      --border-soft: #e5e7eb;
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    /* LOGIN WRAPPER */
    .login-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 32px 16px;
    }

    .login-card {
      background: #0b1220;
      border-radius: 24px;
      display: grid;
      grid-template-columns: minmax(0, 320px) minmax(0, 360px);
      max-width: 800px;
      width: 100%;
      overflow: hidden;
      color: #e5e7eb;
      box-shadow: 0 20px 45px rgba(15, 23, 42, 0.45);
    }

    @media (max-width: 768px) {
      .login-card {
        grid-template-columns: minmax(0, 1fr);
      }
      .login-visual {
        display: none;
      }
    }

    .login-visual {
      padding: 32px 28px;
      background: radial-gradient(circle at top, #1d4ed8, #020617);
      position: relative;
      overflow: hidden;
    }

    .login-visual h1 {
      font-size: 26px;
      margin-bottom: 8px;
    }
    .login-visual p {
      font-size: 14px;
      color: #9ca3af;
      max-width: 260px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid rgba(148, 163, 184, 0.3);
      font-size: 11px;
      margin-bottom: 16px;
    }

    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.35);
    }

    .orbit {
      position: absolute;
      width: 260px;
      height: 260px;
      border-radius: 50%;
      border: 1px dashed rgba(148, 163, 184, 0.35);
      top: 48%;
      right: -60px;
      transform: translateY(-50%);
    }

    .orbit-dot {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #38bdf8;
      top: 10%;
      left: 20%;
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.8);
    }

    .login-form-side {
      background: #f9fafb;
      color: #111827;
      padding: 32px 28px;
    }

    .login-form-side h2 {
      font-size: 20px;
      margin-bottom: 6px;
    }

    .login-form-side p {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 24px;
    }

    .field {
      margin-bottom: 16px;
    }

    .field label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #374151;
    }

    .field input,
    .field select,
    .field textarea {
      width: 100%;
      padding: 9px 11px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 13px;
      outline: none;
      transition: 0.15s border, 0.15s box-shadow, 0.15s background;
      background: #ffffff;
      resize: vertical;
    }

    .field input:focus,
    .field select:focus,
    .field textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.25);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 9px 14px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: 0.18s transform, 0.18s box-shadow, 0.18s background-color;
    }

    .btn-primary {
      background: linear-gradient(to right, #2563eb, #4f46e5);
      color: #ffffff;
      box-shadow: 0 12px 25px rgba(37, 99, 235, 0.5);
      width: 100%;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 35px rgba(37, 99, 235, 0.7);
    }

    .helper-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .helper-row span {
      font-size: 12px;
      color: #6b7280;
    }

    .checkbox-inline {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #4b5563;
    }

    .checkbox-inline input {
      width: 14px;
      height: 14px;
    }

    .tiny-note {
      margin-top: 8px;
      font-size: 11px;
      color: #9ca3af;
    }

    .error-text {
      font-size: 12px;
      color: var(--danger);
      margin-bottom: 8px;
      display: none;
    }

    /* APP LAYOUT */
    .app {
      display: none;
      width: 100%;
      min-height: 100vh;
    }

    .app-layout {
      display: grid;
      grid-template-columns: 240px minmax(0, 1fr);
      width: 100%;
      min-height: 100vh;
    }

    @media (max-width: 900px) {
      .app-layout {
        grid-template-columns: 0 minmax(0, 1fr);
      }
      .sidebar {
        position: fixed;
        inset: 0 auto 0 0;
        width: 220px;
        transform: translateX(-100%);
        transition: 0.25s transform;
        z-index: 40;
      }
      .sidebar.open {
        transform: translateX(0);
      }
      .sidebar-overlay {
        display: block;
      }
      .topbar-menu-btn {
        display: inline-flex;
      }
    }

    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      z-index: 30;
    }

    .sidebar {
      background: var(--sidebar-bg);
      color: #e5e7eb;
      padding: 18px 16px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .logo-mark {
      width: 26px;
      height: 26px;
      border-radius: 10px;
      background: radial-gradient(circle at top, #60a5fa, #1d4ed8);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 700;
      color: #eff6ff;
    }

    .logo-title {
      font-size: 15px;
      font-weight: 600;
    }

    .sidebar-section-label {
      font-size: 11px;
      text-transform: uppercase;
      color: #6b7280;
      letter-spacing: 0.08em;
      margin: 10px 0 4px;
    }

    .nav {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 9px;
      border-radius: 10px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 13px;
      text-align: left;
      cursor: pointer;
      transition: 0.16s background, 0.16s color, 0.16s transform;
    }

    .nav-btn span.icon {
      font-size: 14px;
      width: 18px;
      text-align: center;
    }

    .nav-btn.active {
      background: rgba(37, 99, 235, 0.18);
      color: #e5e7eb;
    }

    .nav-btn:hover {
      background: rgba(55, 65, 81, 0.7);
      transform: translateY(-1px);
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 11px;
      color: #6b7280;
    }

    .sidebar-footer strong {
      color: #e5e7eb;
    }

    .main {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .topbar {
      background: #ffffff;
      border-bottom: 1px solid var(--border-soft);
      padding: 10px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .topbar-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .topbar-title {
      font-size: 17px;
      font-weight: 600;
    }

    .topbar-subtitle {
      font-size: 12px;
      color: var(--text-soft);
    }

    .topbar-menu-btn {
      display: none;
      border-radius: 999px;
      border: none;
      padding: 6px 9px;
      background: #e5e7eb;
      cursor: pointer;
      font-size: 15px;
    }

    .topbar-right {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .chip-role {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--primary-soft);
      color: var(--primary);
      border: 1px solid #bfdbfe;
    }

    .user-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .user-avatar {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: linear-gradient(to bottom right, #2563eb, #4f46e5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #eff6ff;
      font-size: 14px;
      font-weight: 600;
    }

    .user-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .user-meta small {
      font-size: 11px;
      color: var(--text-soft);
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 6px 10px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      cursor: pointer;
    }

    .content {
      padding: 16px 18px 24px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .cards-row {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }

    @media (max-width: 1100px) {
      .cards-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .cards-row {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 12px 14px;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.04);
      border: 1px solid #e5e7eb;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 13px;
      color: var(--text-soft);
    }

    .card-value {
      font-size: 20px;
      font-weight: 600;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .tag-success {
      background: #ecfdf3;
      color: #15803d;
    }

    .tag-danger {
      background: #fef2f2;
      color: #b91c1c;
    }

    .section {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 14px 16px;
      border: 1px solid var(--border-soft);
      display: none;
      flex-direction: column;
      gap: 10px;
    }

    .section.active {
      display: flex;
    }

    .section-header {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .section-header h3 {
      font-size: 16px;
      margin-bottom: 2px;
    }

    .section-header p {
      font-size: 12px;
      color: var(--text-soft);
    }

    .filters-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filters-row select,
    .filters-row input {
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      font-size: 12px;
      background: #f9fafb;
    }

    .btn-sm {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #f9fafb;
      cursor: pointer;
    }

    .btn-sm.primary {
      background: var(--primary);
      color: #ffffff;
      border-color: transparent;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 6px;
    }

    th,
    td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
      vertical-align: middle;
    }

    th {
      background: #f9fafb;
      font-weight: 500;
      color: #4b5563;
    }

    tr:hover td {
      background: #f9fafb;
    }

    .table-actions {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 3px 7px;
      border-radius: 999px;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .badge-pill {
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      color: #4b5563;
    }

    .badge-success {
      background: #ecfdf3;
      color: #15803d;
      border-color: #bbf7d0;
    }

    .badge-warning {
      background: #fffbeb;
      color: #92400e;
      border-color: #facc15;
    }

    .badge-danger {
      background: #fef2f2;
      color: #b91c1c;
      border-color: #fecaca;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      margin-top: 8px;
      margin-bottom: 4px;
    }

    @media (max-width: 1100px) {
      .form-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (max-width: 640px) {
      .form-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .form-grid .field label {
      font-size: 11px;
      margin-bottom: 4px;
    }

    .form-grid .field input,
    .form-grid .field select,
    .form-grid .field textarea {
      font-size: 12px;
      padding: 7px 9px;
      border-radius: 8px;
    }

    .divider {
      border-top: 1px dashed #e5e7eb;
      margin: 6px 0;
    }

    .text-right {
      text-align: right;
    }

    .muted {
      color: var(--text-soft);
    }

    .mt-4 { margin-top: 4px; }
    .mt-8 { margin-top: 8px; }

    .no-data {
      font-size: 12px;
      color: var(--text-soft);
      padding: 4px 0;
    }

    .subtitle-small {
      font-size: 11px;
      color: var(--text-soft);
    }

    .pill-stage {
      padding: 3px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 11px;
    }

    .subsection-title {
      font-size: 13px;
      font-weight: 600;
      margin-top: 6px;
      margin-bottom: 2px;
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      margin-bottom: 4px;
    }

    .checklist-item input {
      width: 14px;
      height: 14px;
    }
  </style>
</head>
<body>
  <!-- LOGIN SCREEN -->
  <div class="login-wrapper" id="loginView">
    <div class="login-card">
      <div class="login-visual">
        <div class="pill">
          <span class="pill-dot"></span>
                  </div>
        <h1>HR Suite</h1>
        <p>
          Personel performansƒ±, puantaj, izin ve onboarding/offboarding
          s√ºre√ßlerinizi tek ekrandan y√∂netin.
        </p>
        <div class="orbit">
          <div class="orbit-dot"></div>
        </div>
      </div>
      <div class="login-form-side">
        <h2>Y√∂netici / Kullanƒ±cƒ± Giri≈üi</h2>
        <p>Sisteme giri≈ü yaparak t√ºm ƒ∞K ve performans mod√ºllerine eri≈üin.</p>
        <div id="loginError" class="error-text">
          Kullanƒ±cƒ± adƒ± veya ≈üifre hatalƒ±.
        </div>
        <div class="field">
          <label for="username">Kullanƒ±cƒ± Adƒ±</label>
          <input id="username" type="text" placeholder="√∂r: ad.soyad" />
        </div>
        <div class="field">
          <label for="password">≈ûifre</label>
          <input id="password" type="password" placeholder="≈ûifre" />
        </div>
        <div class="helper-row">
          <label class="checkbox-inline">
            <input type="checkbox" id="rememberMe" /> Beni hatƒ±rla
          </label>
                  </div>
        <button class="btn btn-primary" id="loginBtn">
          Sisteme Giri≈ü Yap
        </button>
        <div class="tiny-note">
          Bu ekran sadece demo ama√ßlƒ±dƒ±r, ger√ßek bir ≈üifre y√∂netimi veya LDAP entegrasyonu i√ßermez.
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div class="app" id="appView">
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="app-layout">
      <aside class="sidebar" id="sidebar">
        <div>
          <div class="logo">
            <div class="logo-mark">HR</div>
            <div>
              <div class="logo-title">HR Suite</div>
              <div style="font-size: 11px; color: #6b7280">
                Performans & ƒ∞K Y√∂netimi
              </div>
            </div>
          </div>
          <div class="sidebar-section-label">Genel</div>
          <div class="nav">
            <button class="nav-btn active" data-section="dashboard">
              <span class="icon">üìä</span> Dashboard
            </button>
            <button class="nav-btn" data-section="employees">
              <span class="icon">üë•</span> Personeller
            </button>
            <button class="nav-btn" data-section="performance">
              <span class="icon">‚≠ê</span> Performans
            </button>
            <button class="nav-btn" data-section="timesheet">
              <span class="icon">‚è±</span> Puantaj / √áalƒ±≈üma Saatleri
            </button>
            <button class="nav-btn" data-section="leave">
              <span class="icon">üèù</span> ƒ∞zin Talepleri
            </button>
            <button class="nav-btn" data-section="onboarding">
              <span class="icon">üß©</span> Onboarding / Offboarding
            </button>
          </div>

          <div class="sidebar-section-label">Y√∂netim</div>
          <div class="nav">
            <button class="nav-btn" data-section="reports">
              <span class="icon">üìë</span> Raporlar
            </button>
            <button class="nav-btn" data-section="settings">
              <span class="icon">‚öôÔ∏è</span> Ayarlar
            </button>
          </div>
        </div>
        <div class="sidebar-footer">
          <div>Baƒülƒ± birim: <strong>ƒ∞≈ületme & ƒ∞K</strong></div>
          <div>S√ºr√ºm: v0.3 demo</div>
        </div>
      </aside>

      <main class="main">
        <header class="topbar">
          <div class="topbar-left">
            <button class="topbar-menu-btn" id="topbarMenuBtn">‚ò∞</button>
            <div>
              <div class="topbar-title">HR Suite Dashboard</div>
              <div class="topbar-subtitle">
                Personel performansƒ±, puantaj, izin ve onboarding s√ºre√ßleri tek ekranda.
              </div>
            </div>
          </div>
          <div class="topbar-right">
            <span class="chip-role" id="chipRole">Rol: -</span>
            <button class="btn-ghost" id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
            <div class="user-badge" id="userBadge">
              <div class="user-avatar" id="userAvatar">US</div>
              <div class="user-meta">
                <span id="userNameLabel">Kullanƒ±cƒ±</span>
                <small>Baƒülƒ± Birim</small>
              </div>
            </div>
          </div>
        </header>

        <section class="content">
          <!-- METRIC CARDS -->
          <div class="cards-row">
            <div class="card" id="metricEmployees">
              <div class="card-header">
                <span class="card-title">Toplam Personel</span>
                <span class="tag">Aktif</span>
              </div>
              <div class="card-value" id="metricTotalEmployees">0</div>
              <div class="mt-4 muted" id="metricEmployeesDetail"></div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Aktif Performans Formu</span>
                <span class="tag tag-success">Devam Ediyor</span>
              </div>
              <div class="card-value" id="metricActiveReviews">0</div>
              <div class="mt-4 muted">
                A√ßƒ±k durumdaki performans puan / formlarƒ±.
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Bug√ºnk√º Puantaj</span>
                <span class="tag">G√ºnl√ºk</span>
              </div>
              <div class="card-value" id="metricTodayHours">0 sa</div>
              <div class="mt-4 muted" id="metricTodayDetail"></div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Bekleyen ƒ∞zin Talebi</span>
                <span class="tag tag-danger">Onay Bekliyor</span>
              </div>
              <div class="card-value" id="metricPendingLeaves">0</div>
              <div class="mt-4 muted">
                M√ºhendis / M√ºd√ºr onayƒ± bekleyen talepler.
              </div>
            </div>
          </div>

          <!-- DASHBOARD SECTION -->
          <div class="section active" id="section-dashboard">
            <div class="section-header">
              <div>
                <h3>Genel Bakƒ±≈ü</h3>
                <p>ƒ∞K, performans ve operasyon metriklerinin √∂zeti.</p>
              </div>
              <div class="filters-row">
                <select id="dashboardPeriod">
                  <option value="month">Bu Ay</option>
                  <option value="quarter">Bu √áeyrek</option>
                  <option value="year">Bu Yƒ±l</option>
                </select>
                <button class="btn-sm" id="btnRefreshDashboard">Yenile</button>
              </div>
            </div>
            <div class="divider"></div>
            <div class="mt-4 muted">
              Demo versiyonda grafik yerine metrik kartlarƒ± g√∂sterilmektedir.
              Ger√ßek projede Chart.js vb. eklenebilir.
            </div>
          </div>

          <!-- EMPLOYEES SECTION -->
          <div class="section" id="section-employees">
            <div class="section-header">
              <div>
                <h3>Personel Y√∂netimi</h3>
                <p>Personel ekleyin, g√ºncelleyin ve durumlarƒ±nƒ± y√∂netin.</p>
              </div>
              <div class="filters-row">
                <input type="text" id="employeeSearch" placeholder="ƒ∞sim / departman ara..." />
                <select id="employeeFilterStatus">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Aktif">Aktif</option>
                  <option value="Pasif">Pasif</option>
                </select>
                <button class="btn-sm primary" id="btnAddEmployee">+ Yeni Personel</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="employeeForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Ad Soyad</label>
                  <input type="text" id="empName" placeholder="√ñrn: Ali Yƒ±lmaz" required />
                </div>
                <div class="field">
                  <label>Departman</label>
                  <input type="text" id="empDepartment" placeholder="√ñrn: Operasyon" />
                </div>
                <div class="field">
                  <label>Pozisyon</label>
                  <input type="text" id="empPosition" placeholder="√ñrn: Saha Operat√∂r√º" />
                </div>
                <div class="field">
                  <label>Durum</label>
                  <select id="empStatus">
                    <option value="Aktif">Aktif</option>
                    <option value="Pasif">Pasif</option>
                  </select>
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelEmployeeEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="empEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Ad Soyad</th>
                    <th>Departman</th>
                    <th>Pozisyon</th>
                    <th>Durum</th>
                    <th>Baƒülƒ± M√ºhendis</th>
                    <th>Baƒülƒ± M√ºd√ºr</th>
                    <th>ƒ∞K Sorumlusu</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="employeeTableBody"></tbody>
              </table>
              <div id="employeeNoData" class="no-data" style="display:none">
                Hen√ºz personel eklenmemi≈ü.
              </div>
            </div>
          </div>

          <!-- PERFORMANCE SECTION -->
          <div class="section" id="section-performance">
            <div class="section-header">
              <div>
                <h3>Performans Y√∂netimi</h3>
                <p>Basit puan kayƒ±tlarƒ± ve Rafineri & Terminal M√ºhendislik performans formu.</p>
              </div>
              <div class="filters-row">
                <select id="perfPeriod">
                  <option value="2025Q1">2025 Q1</option>
                  <option value="2025Q2">2025 Q2</option>
                  <option value="2025Q3">2025 Q3</option>
                  <option value="2025Q4" selected>2025 Q4</option>
                </select>
                <button class="btn-sm primary" id="btnAddPerf">+ Basit Performans Kaydƒ±</button>
              </div>
            </div>
            <div class="divider"></div>

            <!-- Basit skor formu -->
            <form id="perfForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="perfEmployee"></select>
                </div>
                <div class="field">
                  <label>D√∂nem</label>
                  <input type="text" id="perfPeriodInput" placeholder="2025 Q4" />
                </div>
                <div class="field">
                  <label>Genel Puan (0-100)</label>
                  <input type="number" id="perfScore" min="0" max="100" placeholder="√∂r: 87" />
                </div>
                <div class="field">
                  <label>Yorum</label>
                  <input type="text" id="perfComment" placeholder="√ñrn: Hedefleri %95 oranƒ±nda tamamladƒ±." />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelPerfEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="perfEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>D√∂nem</th>
                    <th>Puan</th>
                    <th>Yorum</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="perfTableBody"></tbody>
              </table>
              <div id="perfNoData" class="no-data" style="display:none">
                Hen√ºz performans kaydƒ± eklenmemi≈ü.
              </div>
            </div>

            <div class="divider"></div>

            <!-- Rafineri & Terminal M√ºhendislik Performans Formu -->
            <div class="mt-4">
              <div class="subsection-title">
                Rafineri & Terminal M√ºhendislik Performans Formlarƒ±
              </div>
              <div class="subtitle-small">
                SAP SuccessFactors mantƒ±ƒüƒ±nda: Form ‚Üí Ara Deƒüerlendirme ‚Üí Yƒ±l Sonu (Personel / Y√∂netici / ƒ∞K akƒ±≈üƒ±)
              </div>
            </div>

            <form id="perf2CreateForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="perf2Employee"></select>
                </div>
                <div class="field">
                  <label>Yƒ±l</label>
                  <input type="number" id="perf2Year" placeholder="2025" />
                </div>
                <div class="field">
                  <label>Rol / Kapsam</label>
                  <input type="text" id="perf2Role" value="M√ºhendislik - Rafineri & Terminal" />
                </div>
                <div class="field">
                  <label>Form A√ßƒ±klamasƒ±</label>
                  <input type="text" id="perf2Desc" placeholder="√ñrn: 2025 M√ºhendislik Performans Formu" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>KPI - ƒ∞≈ü G√ºvenliƒüi & HSSE</label>
                  <input type="text" id="perf2KpiSafety" placeholder="√ñrn: SIF sƒ±fƒ±r kaza, PTW uyumu..." />
                </div>
                <div class="field">
                  <label>KPI - Operasyon & S√ºre√ß</label>
                  <input type="text" id="perf2KpiOps" placeholder="√ñrn: Tank devreye alma, arƒ±za y√∂netimi..." />
                </div>
                <div class="field">
                  <label>KPI - Projeler & ƒ∞yile≈ütirme</label>
                  <input type="text" id="perf2KpiProjects" placeholder="√ñrn: CAPEX projelerine katkƒ±..." />
                </div>
                <div class="field">
                  <label>KPI - Liderlik & Takƒ±m √áalƒ±≈ümasƒ±</label>
                  <input type="text" id="perf2KpiLeadership" placeholder="√ñrn: Ekip ko√ßluƒüu, devreye alma liderliƒüi..." />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="submit" class="btn-sm primary">+ Performans Formu Olu≈ütur</button>
              </div>
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Yƒ±l</th>
                    <th>Rol</th>
                    <th>A≈üama</th>
                    <th>Ara Ort.</th>
                    <th>Yƒ±l Sonu Ort.</th>
                    <th>Final Puan</th>
                    <th style="width: 140px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="perf2TableBody"></tbody>
              </table>
              <div id="perf2NoData" class="no-data" style="display:none">
                Hen√ºz m√ºhendislik performans formu olu≈üturulmamƒ±≈ü.
              </div>
            </div>

            <div id="perf2DetailPanel" class="mt-8" style="display:none;">
              <div class="subsection-title">Se√ßili Form Detayƒ±</div>
              <div class="muted" id="perf2DetailHeader"></div>
              <input type="hidden" id="perf2DetailId" value="" />

              <div class="mt-4">
                <span class="subtitle-small">A≈üama:</span>
                <span class="pill-stage" id="perf2StageLabel"></span>
              </div>

              <div class="subsection-title">1) ƒ∞lk Form (Personel ‚Üí Y√∂netici ‚Üí ƒ∞K)</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2InitEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2InitMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2InitHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2InitNote" placeholder="ƒ∞lk form notlarƒ±" />
                </div>
              </div>

              <div class="subsection-title">2) Ara D√∂nem Deƒüerlendirme</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2MidEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2MidMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2MidHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2MidNote" placeholder="Ara d√∂nem notlarƒ±" />
                </div>
              </div>

              <div class="subsection-title">3) Yƒ±l Sonu Deƒüerlendirme</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2YearEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2YearMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2YearHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2YearNote" placeholder="Yƒ±l sonu notlarƒ±" />
                </div>
              </div>

              <div class="mt-4 subtitle-small" id="perf2SummaryText"></div>

              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnPerf2Advance">A≈üamayƒ± ƒ∞lerle (Demo)</button>
                <button type="button" class="btn-sm primary" id="btnPerf2Save">Formu Kaydet</button>
              </div>

              <div class="tiny-note">
                Ger√ßek sistemde bu a≈üamalar rol bazlƒ± (Personel / Y√∂netici / ƒ∞K) login ile
                kƒ±sƒ±tlanabilir. Burada t√ºm alanlar admin tarafƒ±ndan g√∂r√ºlebilen demo ama√ßlƒ±dƒ±r.
              </div>
            </div>
          </div>

          <!-- TIMESHEET SECTION -->
          <div class="section" id="section-timesheet">
            <div class="section-header">
              <div>
                <h3>Puantaj / √áalƒ±≈üma Saatleri</h3>
                <p>Vardiya ve g√ºnl√ºk √ßalƒ±≈üma saatlerini y√∂netin.</p>
              </div>
              <div class="filters-row">
                <input type="month" id="timesheetMonth" />
                <select id="timesheetEmployeeFilter"></select>
                <button class="btn-sm primary" id="btnAddTimesheet">+ Kayƒ±t Ekle</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="timesheetForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="tsEmployee"></select>
                </div>
                <div class="field">
                  <label>Tarih</label>
                  <input type="date" id="tsDate" />
                </div>
                <div class="field">
                  <label>Toplam Saat</label>
                  <input type="number" id="tsHours" step="0.5" min="0" max="24" placeholder="√∂r: 8" />
                </div>
                <div class="field">
                  <label>Vardiya</label>
                  <input type="text" id="tsShift" placeholder="√ñrn: G√ºnd√ºz" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelTsEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="tsEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Tarih</th>
                    <th>Saat</th>
                    <th>Vardiya</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="tsTableBody"></tbody>
              </table>
              <div id="tsNoData" class="no-data" style="display:none">
                Hen√ºz puantaj kaydƒ± eklenmemi≈ü.
              </div>
            </div>
          </div>

          <!-- LEAVE SECTION -->
          <div class="section" id="section-leave">
            <div class="section-header">
              <div>
                <h3>ƒ∞zin Talepleri</h3>
                <p>Yƒ±llƒ±k izin, mazeret izni ve √ßok adƒ±mlƒ± onay s√ºre√ßleri.</p>
              </div>
              <div class="filters-row">
                <select id="leaveStatusFilter">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Bekliyor">Bekliyor</option>
                  <option value="Onaylandƒ±">Onaylandƒ±</option>
                  <option value="Reddedildi">Reddedildi</option>
                </select>
                <button class="btn-sm primary" id="btnAddLeave">+ Yeni ƒ∞zin Talebi</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="leaveForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="leaveEmployee"></select>
                </div>
                <div class="field">
                  <label>ƒ∞zin T√ºr√º</label>
                  <select id="leaveType">
                    <option value="Yƒ±llƒ±k ƒ∞zin">Yƒ±llƒ±k ƒ∞zin</option>
                    <option value="Mazeret ƒ∞zni">Mazeret ƒ∞zni</option>
                    <option value="Hastalƒ±k ƒ∞zni">Hastalƒ±k ƒ∞zni</option>
                    <option value="√úcretsiz ƒ∞zin">√úcretsiz ƒ∞zin</option>
                  </select>
                </div>
                <div class="field">
                  <label>Ba≈ülangƒ±√ß Tarihi</label>
                  <input type="date" id="leaveStart" />
                </div>
                <div class="field">
                  <label>Biti≈ü Tarihi</label>
                  <input type="date" id="leaveEnd" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>G√ºn Sayƒ±sƒ±</label>
                  <input type="number" id="leaveDays" min="0" step="0.5" placeholder="Otomatik veya manuel" />
                </div>
                <div class="field">
                  <label>Baƒülƒ± M√ºhendis</label>
                  <input type="text" id="leaveEngineer" placeholder="√ñrn: Saha M√ºhendisi" />
                </div>
                <div class="field">
                  <label>Departman M√ºd√ºr√º</label>
                  <input type="text" id="leaveManager" placeholder="√ñrn: Operasyon M√ºd√ºr√º" />
                </div>
                <div class="field">
                  <label>Durum</label>
                  <select id="leaveStatus">
                    <option value="Bekliyor">Bekliyor</option>
                    <option value="Onaylandƒ±">Onaylandƒ±</option>
                    <option value="Reddedildi">Reddedildi</option>
                  </select>
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>A√ßƒ±klama</label>
                  <input type="text" id="leaveReason" placeholder="√ñrn: Yƒ±llƒ±k izin planƒ±" />
                </div>
                <div class="field">
                  <label>Onaylayan Notu</label>
                  <input type="text" id="leaveApprover" placeholder="√ñrn: M√ºd√ºr notu" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelLeaveEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="leaveEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>T√ºr</th>
                    <th>Ba≈ülangƒ±√ß</th>
                    <th>Biti≈ü</th>
                    <th>G√ºn</th>
                    <th>Onay Zinciri</th>
                    <th>Durum</th>
                    <th style="width: 170px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="leaveTableBody"></tbody>
              </table>
              <div id="leaveNoData" class="no-data" style="display:none">
                Hen√ºz izin talebi bulunmuyor.
              </div>
            </div>
          </div>

          <!-- ONBOARDING / OFFBOARDING SECTION -->
          <div class="section" id="section-onboarding">
            <div class="section-header">
              <div>
                <h3>Onboarding / Offboarding</h3>
                <p>Personel katƒ±lƒ±m ve ayrƒ±lƒ±≈ü s√ºre√ßlerini SAP SuccessFactors benzeri takip edin.</p>
              </div>
              <div class="filters-row">
                <select id="onbTypeFilter">
                  <option value="">T√ºm Tipler</option>
                  <option value="Onboarding">Onboarding</option>
                  <option value="Offboarding">Offboarding</option>
                </select>
                <select id="onbStatusFilter">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Devam Ediyor">Devam Ediyor</option>
                  <option value="Tamamlandƒ±">Tamamlandƒ±</option>
                </select>
              </div>
            </div>
            <div class="divider"></div>

            <form id="onbForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="onbEmployee"></select>
                </div>
                <div class="field">
                  <label>S√ºre√ß Tipi</label>
                  <select id="onbType">
                    <option value="Onboarding">Onboarding (Katƒ±lƒ±m)</option>
                    <option value="Offboarding">Offboarding (Ayrƒ±lƒ±≈ü)</option>
                  </select>
                </div>
                <div class="field">
                                    <label>Ba≈ülangƒ±√ß Tarihi</label>
                  <input type="date" id="onbStartDate" />
                </div>
                <div class="field">
                  <label>Sorumlu</label>
                  <input type="text" id="onbOwner" placeholder="√ñrn: ƒ∞K Uzmanƒ± / Operasyon ≈ûefi" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>A√ßƒ±klama</label>
                  <input type="text" id="onbNotes" placeholder="√ñrn: Yeni saha m√ºhendisi onboarding" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="submit" class="btn-sm primary">+ S√ºre√ß Olu≈ütur</button>
              </div>
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Tip</th>
                    <th>Ba≈ülangƒ±√ß</th>
                    <th>G√∂rev Durumu</th>
                    <th>Durum</th>
                    <th style="width: 150px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="onbTableBody"></tbody>
              </table>
              <div id="onbNoData" class="no-data" style="display:none">
                Hen√ºz onboarding / offboarding s√ºreci olu≈üturulmamƒ±≈ü.
              </div>
            </div>

            <div id="onbDetailPanel" class="mt-8" style="display:none;">
              <div class="subsection-title">G√∂rev Checklist</div>
              <div class="muted" id="onbDetailHeader"></div>
              <div id="onbTasksContainer" class="mt-4"></div>
              <div class="tiny-note">
                G√∂revler tamamlandƒ±k√ßa s√ºre√ß durumu otomatik g√ºncellenir. Ger√ßek sistemde bu adƒ±mlar
                ilgili ekipler ve departmanlara g√∂rev olarak daƒüƒ±tƒ±labilir.
              </div>
            </div>
          </div>

          <!-- REPORTS SECTION -->
          <div class="section" id="section-reports">
            <div class="section-header">
              <div>
                <h3>Raporlar</h3>
                <p>Excel / PDF entegrasyonuna hazƒ±r basit rapor ≈üablonlarƒ±.</p>
              </div>
              <div class="filters-row">
                <select id="reportType">
                  <option value="perf">Performans √ñzeti</option>
                  <option value="leave">ƒ∞zin √ñzeti</option>
                  <option value="timesheet">Puantaj √ñzeti</option>
                </select>
                <button class="btn-sm primary" id="btnExportDummy">Excel'e Aktar (Mock)</button>
              </div>
            </div>
            <div class="divider"></div>
            <div class="mt-4 muted">
              Bu demo versiyonda ger√ßek dosya √ºretimi yoktur. Arka tarafta Node.js
              veya Django API ile JSON ‚Üí Excel/PDF d√∂n√º≈üt√ºr√ºp indirme butonuna baƒülayabilirsiniz.
            </div>
          </div>

          <!-- SETTINGS SECTION -->
          <div class="section" id="section-settings">
            <div class="section-header">
              <div>
                <h3>Ayarlar</h3>
                <p>≈ûirket, performans d√∂nemleri ve demo ayarlarƒ±nƒ± y√∂netin.</p>
              </div>
            </div>
            <div class="divider"></div>
            <div class="form-grid mt-4">
              <div class="field">
                <label>≈ûirket Adƒ±</label>
                <input id="cfgCompanyName" type="text" placeholder="√ñrn: ATA≈û" />
              </div>
              <div class="field">
                <label>Varsayƒ±lan √áalƒ±≈üma Saati / G√ºn</label>
                <input id="cfgDefaultDailyHours" type="number" min="1" max="24" step="0.5" placeholder="8" />
              </div>
              <div class="field">
                <label>Performans D√∂nemi</label>
                <input id="cfgPerfPeriod" type="text" placeholder="√ñrn: 2025 Yƒ±llƒ±k" />
              </div>
              <div class="field">
                <label>Demo Modu</label>
                <select id="cfgDemoMode">
                  <option value="on">A√ßƒ±k</option>
                  <option value="off">Kapalƒ±</option>
                </select>
              </div>
            </div>

            <div class="subsection-title mt-8">Performans Formu D√∂nem Son Tarihleri</div>
            <div class="form-grid mt-4">
              <div class="field">
                <label>ƒ∞lk Form Son Tarihi</label>
                <input type="date" id="cfgPerfInitialEnd" />
              </div>
              <div class="field">
                <label>Ara Deƒüerlendirme Son Tarihi</label>
                <input type="date" id="cfgPerfMidEnd" />
              </div>
              <div class="field">
                <label>Yƒ±l Sonu Deƒüerlendirme Son Tarihi</label>
                <input type="date" id="cfgPerfYearEnd" />
              </div>
            </div>

            <div class="text-right mt-4">
              <button class="btn-sm primary" id="btnSaveSettings">Ayarlarƒ± Kaydet</button>
            </div>
            <div class="tiny-note">
              Ayarlar localStorage'a kaydedilir. Ger√ßek projede bu alanlarƒ± backend (PostgreSQL vb.)
              ile kalƒ±cƒ± hale getirip cron job ile 1 hafta / 5 g√ºn / 2 g√ºn √∂nceden e-posta hatƒ±rlatmalarƒ±
              g√∂nderebilirsiniz.
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    // ----------------- HELPER FONKSƒ∞YONLAR -----------------
    const STORAGE_KEYS = {
      employees: "hrsuite_employees",
      performance: "hrsuite_performance",
      timesheets: "hrsuite_timesheets",
      leaves: "hrsuite_leaves",
      perfForms: "hrsuite_perf_forms",
      onboarding: "hrsuite_onboarding",
      settings: "hrsuite_settings",
      lastUser: "hrsuite_last_user",
    };

    function loadData(key, def) {
      try {
        const raw = localStorage.getItem(key);
        return raw ? JSON.parse(raw) : def;
      } catch (e) {
        return def;
      }
    }

    function saveData(key, val) {
      localStorage.setItem(key, JSON.stringify(val));
    }

    // T√ºrk√ße karakter normalize (kullanƒ±cƒ± adƒ± / ≈üifre i√ßin)
    function trNormalize(str) {
      const map = {
        "√ß": "c", "√á": "C",
        "ƒü": "g", "ƒû": "G",
        "ƒ±": "i", "ƒ∞": "I",
        "√∂": "o", "√ñ": "O",
        "≈ü": "s", "≈û": "S",
        "√º": "u", "√ú": "U"
      };
      return str.replace(/[√ß√áƒüƒûƒ±ƒ∞√∂√ñ≈ü≈û√º√ú]/g, ch => map[ch] || ch);
    }

    function makeUsername(first, last) {
      const f = trNormalize(first).toLowerCase().replace(/\s+/g, "");
      const l = trNormalize(last).toLowerCase();
      return f + "." + l;
    }

    function makePassword(first) {
      const base = trNormalize(first.split(" ")[0]);
      return base.charAt(0).toUpperCase() + base.slice(1) + "123";
    }

    // ----------------- GLOBAL STATE -----------------
    let employees = loadData(STORAGE_KEYS.employees, []);
    let performance = loadData(STORAGE_KEYS.performance, []);
    let timesheets = loadData(STORAGE_KEYS.timesheets, []);
    let leaves = loadData(STORAGE_KEYS.leaves, []);
    let perfForms = loadData(STORAGE_KEYS.perfForms, []);
    let onboarding = loadData(STORAGE_KEYS.onboarding, []);
    let settings = loadData(STORAGE_KEYS.settings, {
      companyName: "HR Suite Demo",
      defaultDailyHours: 8,
      perfPeriod: "2025",
      demoMode: "on",
      performancePeriods: {
        initialEnd: "",
        midEnd: "",
        yearEnd: "",
      },
    });

    let currentUser = null;

    // ƒ∞lk a√ßƒ±lƒ±≈üta √∂rnek personelleri y√ºkle (sadece liste bo≈üsa)
    function ensureSeedEmployees() {
  let stored = loadData(STORAGE_KEYS.employees, []);

  // Hi√ß veri yoksa √∂rnek kullanƒ±cƒ±larƒ± y√ºkle
  if (!stored || !Array.isArray(stored) || stored.length === 0) {
    const seed = [
      {
        id: "emp1",
        firstName: "Remzi Can",
        lastName: "Ergin",
        email: "remzican.ergin@atasterminal.com",
        role: "M√ºhendis",
        department: "ƒ∞≈ületme",
        position: "Operasyon M√ºhendisi",
        baƒülƒ±M√ºhendisEmail: "",
        baƒülƒ±M√ºd√ºrEmail: "aytac.celik@atasterminal.com",
        baƒülƒ±ƒ∞kEmail: "nesibe.esen@atasterminal.com",
        status: "Aktif",
      },
      {
        id: "emp2",
        firstName: "Hasan",
        lastName: "Demir",
        email: "hasan.demir@atasterminal.com",
        role: "Operat√∂r",
        department: "ƒ∞≈ületme",
        position: "Vardiya ≈ûefi",
        baƒülƒ±M√ºhendisEmail: "remzican.ergin@atasterminal.com",
        baƒülƒ±M√ºd√ºrEmail: "aytac.celik@atasterminal.com",
        baƒülƒ±ƒ∞kEmail: "nesibe.esen@atasterminal.com",
        status: "Aktif",
      },
      {
        id: "emp3",
        firstName: "Aytac",
        lastName: "√áelik",
        email: "aytac.celik@atasterminal.com",
        role: "M√ºd√ºr",
        department: "ƒ∞≈ületme",
        position: "ƒ∞≈ületme M√ºd√ºr√º",
        baƒülƒ±M√ºhendisEmail: "",
        baƒülƒ±M√ºd√ºrEmail: "",
        baƒülƒ±ƒ∞kEmail: "nesibe.esen@atasterminal.com",
        status: "Aktif",
      },
      {
        id: "emp4",
        firstName: "Nesibe",
        lastName: "Esen",
        email: "nesibe.esen@atasterminal.com",
        role: "ƒ∞K",
        department: "ƒ∞K",
        position: "ƒ∞K M√ºd√ºr√º",
        baƒülƒ±M√ºhendisEmail: "",
        baƒülƒ±M√ºd√ºrEmail: "",
        baƒülƒ±ƒ∞kEmail: "nesibe.esen@atasterminal.com",
        status: "Aktif",
      },
    ];

    employees = seed.map(e => ({
      ...e,
      name: e.firstName + " " + e.lastName,
      username: makeUsername(e.firstName, e.lastName),
      password: makePassword(e.firstName),
    }));
  }

  // Veri varsa ‚Äì eksik kullanƒ±cƒ± adƒ±/≈üifreleri otomatik ekle
  else {
    employees = stored.map(e => {
      // ad-soyad d√ºzeltme
      const name = e.name || ((e.firstName || "") + " " + (e.lastName || "")).trim();
      const parts = name.split(" ").filter(Boolean);
      const firstName = e.firstName || parts.slice(0, -1).join(" ") || parts[0] || "";
      const lastName = e.lastName || parts.slice(-1)[0] || "";

      return {
        ...e,
        name,
        firstName,
        lastName,
        username: e.username || makeUsername(firstName, lastName || "user"),
        password: e.password || makePassword(firstName),
      };
    });
  }

  saveData(STORAGE_KEYS.employees, employees);
}


    // ----------------- LOGIN -----------------
    const loginView = document.getElementById("loginView");
    const appView = document.getElementById("appView");
    const loginBtn = document.getElementById("loginBtn");
    const loginError = document.getElementById("loginError");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    const rememberMe = document.getElementById("rememberMe");

    const userNameLabel = document.getElementById("userNameLabel");
    const userAvatar = document.getElementById("userAvatar");
    const chipRole = document.getElementById("chipRole");

    function updateUserBadge() {
      if (!currentUser) return;
      userNameLabel.textContent = currentUser.name;
      chipRole.textContent = "Rol: " + currentUser.role;
      const initials = currentUser.firstName.charAt(0) + currentUser.lastName.charAt(0);
      userAvatar.textContent = initials.toUpperCase();
      const meta = document.querySelector(".user-meta small");
      if (meta) meta.textContent = currentUser.department + " - " + currentUser.position;
    }

    function setLoggedIn(user) {
      currentUser = user;
      loginView.style.display = "none";
      appView.style.display = "block";
      updateUserBadge();
      applyRoleVisibility();
      refreshAllUI();
    }

    function logout() {
      currentUser = null;
      appView.style.display = "none";
      loginView.style.display = "flex";
      passwordInput.value = "";
    }

    const lastUser = loadData(STORAGE_KEYS.lastUser, null);
    if (lastUser && lastUser.username) {
      usernameInput.value = lastUser.username;
      rememberMe.checked = true;
    }

    loginBtn.addEventListener("click", function (e) {
      e.preventDefault();
      ensureSeedEmployees();

      const u = usernameInput.value.trim();
      const p = passwordInput.value.trim();

      const found = employees.find(emp => emp.username === u && emp.password === p);
      if (found) {
        loginError.style.display = "none";
        if (rememberMe.checked) {
          saveData(STORAGE_KEYS.lastUser, { username: u });
        } else {
          localStorage.removeItem(STORAGE_KEYS.lastUser);
        }
        setLoggedIn(found);
      } else {
        loginError.style.display = "block";
      }
    });

    document.getElementById("logoutBtn").addEventListener("click", logout);

    // ----------------- NAV & SECTION G√ñR√úN√úRL√úK -----------------
    const sidebar = document.getElementById("sidebar");
    const sidebarOverlay = document.getElementById("sidebarOverlay");
    const topbarMenuBtn = document.getElementById("topbarMenuBtn");
    const navButtons = document.querySelectorAll(".nav-btn");

    const sections = {
      dashboard: document.getElementById("section-dashboard"),
      employees: document.getElementById("section-employees"),
      performance: document.getElementById("section-performance"),
      timesheet: document.getElementById("section-timesheet"),
      leave: document.getElementById("section-leave"),
      onboarding: document.getElementById("section-onboarding"),
      reports: document.getElementById("section-reports"),
      settings: document.getElementById("section-settings"),
    };

    function openSidebar() {
      sidebar.classList.add("open");
      sidebarOverlay.style.display = "block";
    }
    function closeSidebar() {
      sidebar.classList.remove("open");
      sidebarOverlay.style.display = "none";
    }

    topbarMenuBtn.addEventListener("click", openSidebar);
    sidebarOverlay.addEventListener("click", closeSidebar);

    navButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const sec = btn.dataset.section;
        navButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        Object.values(sections).forEach(s => s.classList.remove("active"));
        sections[sec].classList.add("active");
        closeSidebar();
      });
    });

    function setNavVisible(sectionId, visible) {
      const btn = document.querySelector('.nav-btn[data-section="' + sectionId + '"]');
      if (btn) btn.style.display = visible ? "flex" : "none";
    }

    function applyRoleVisibility() {
      if (!currentUser) return;
      const role = currentUser.role;

      // Varsayƒ±lan: hepsi a√ßƒ±k
      setNavVisible("dashboard", true);
      setNavVisible("employees", true);
      setNavVisible("performance", true);
      setNavVisible("timesheet", true);
      setNavVisible("leave", true);
      setNavVisible("onboarding", true);
      setNavVisible("reports", true);
      setNavVisible("settings", true);

      // Buton √∂zel gizlemeler
      if (role === "Operat√∂r") {
        setNavVisible("employees", false);
        setNavVisible("performance", false);
        setNavVisible("timesheet", false);
        setNavVisible("onboarding", false);
        setNavVisible("reports", false);
        setNavVisible("settings", false);
      } else if (role === "M√ºhendis") {
        setNavVisible("employees", false);
        setNavVisible("timesheet", false);
        setNavVisible("onboarding", false);
        // rapor ve settings kalsƒ±n
      } else if (role === "M√ºd√ºr") {
        // m√ºd√ºr her ≈üeyi neredeyse g√∂rs√ºn, sadece settings'i ƒ∞K'ya bƒ±rakmak istersen:
        // setNavVisible("settings", false);
      } else if (role === "ƒ∞K") {
        // full access
      }

      // Personel ekleme butonu sadece ƒ∞K
      const btnAddEmployee = document.getElementById("btnAddEmployee");
      if (btnAddEmployee) {
        btnAddEmployee.style.display = (role === "ƒ∞K") ? "inline-block" : "none";
      }
    }

    // ----------------- UI REFRESH FONKSƒ∞YONLARI -----------------
    const metricTotalEmployees = document.getElementById("metricTotalEmployees");
    const metricEmployeesDetail = document.getElementById("metricEmployeesDetail");
    const metricActiveReviews = document.getElementById("metricActiveReviews");
    const metricTodayHours = document.getElementById("metricTodayHours");
    const metricTodayDetail = document.getElementById("metricTodayDetail");
    const metricPendingLeaves = document.getElementById("metricPendingLeaves");

    function refreshMetrics() {
      metricTotalEmployees.textContent = employees.length.toString();
      const aktif = employees.filter(e => e.status === "Aktif").length;
      metricEmployeesDetail.textContent = aktif + " aktif, " + (employees.length - aktif) + " pasif personel";

      metricActiveReviews.textContent = perfForms.length.toString();

      const todayStr = new Date().toISOString().slice(0, 10);
      const todayTs = timesheets.filter(t => t.date === todayStr);
      const sumHours = todayTs.reduce((acc, t) => acc + Number(t.hours || 0), 0);
      metricTodayHours.textContent = sumHours + " sa";
      metricTodayDetail.textContent = todayTs.length + " kayƒ±t";

      const pending = leaves.filter(l => l.status === "Bekliyor").length;
      metricPendingLeaves.textContent = pending.toString();
    }

    // Personel tablo + select doldurma
    const employeeTableBody = document.getElementById("employeeTableBody");
    const employeeNoData = document.getElementById("employeeNoData");

    function populateEmployeeSelect(selectEl, filterFn) {
      if (!selectEl) return;
      const list = filterFn ? employees.filter(filterFn) : employees;
      selectEl.innerHTML = "";
      list.forEach(e => {
        const opt = document.createElement("option");
        opt.value = e.id;
        opt.textContent = e.name;
        selectEl.appendChild(opt);
      });
    }

    function refreshEmployeesUI() {
      if (!employeeTableBody) return;

      employeeTableBody.innerHTML = "";
      if (!employees.length) {
        employeeNoData.style.display = "block";
      } else {
        employeeNoData.style.display = "none";
        employees.forEach(emp => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${emp.name}</td>
            <td>${emp.department || ""}</td>
            <td>${emp.position || ""}</td>
            <td>${emp.status || "Aktif"}</td>
            <td>${emp.baƒülƒ±M√ºhendisEmail || ""}</td>
            <td>${emp.baƒülƒ±M√ºd√ºrEmail || ""}</td>
            <td>${emp.baƒülƒ±ƒ∞kEmail || ""}</td>
            <td>
              <div class="table-actions">
                <button type="button" class="btn-sm" onclick="editEmployee('${emp.id}')">D√ºzenle</button>
              </div>
            </td>
          `;
          employeeTableBody.appendChild(tr);
        });
      }

      // Diƒüer selectler
      populateEmployeeSelect(document.getElementById("perfEmployee"));
      populateEmployeeSelect(document.getElementById("perf2Employee"));
      populateEmployeeSelect(document.getElementById("tsEmployee"));
      populateEmployeeSelect(document.getElementById("timesheetEmployeeFilter"));
      populateEmployeeSelect(document.getElementById("leaveEmployee"));
      populateEmployeeSelect(document.getElementById("onbEmployee"));
    }

    // Performans (basit)
    const perfTableBody = document.getElementById("perfTableBody");
    const perfNoData = document.getElementById("perfNoData");

    function refreshPerformanceUI() {
      perfTableBody.innerHTML = "";
      if (!performance.length) {
        perfNoData.style.display = "block";
      } else {
        perfNoData.style.display = "none";
        performance.forEach(p => {
          const emp = employees.find(e => e.id === p.empId);
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${emp ? emp.name : "-"}</td>
            <td>${p.period || ""}</td>
            <td>${p.score || ""}</td>
            <td>${p.comment || ""}</td>
            <td>
              <div class="table-actions">
                <button type="button" class="btn-sm" onclick="editPerf('${p.id}')">D√ºzenle</button>
              </div>
            </td>
          `;
          perfTableBody.appendChild(tr);
        });
      }
    }

    // Puantaj
    const tsTableBody = document.getElementById("tsTableBody");
    const tsNoData = document.getElementById("tsNoData");

    function refreshTimesheetUI() {
      tsTableBody.innerHTML = "";
      if (!timesheets.length) {
        tsNoData.style.display = "block";
      } else {
        tsNoData.style.display = "none";
        timesheets.forEach(t => {
          const emp = employees.find(e => e.id === t.empId);
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${emp ? emp.name : "-"}</td>
            <td>${t.date}</td>
            <td>${t.hours}</td>
            <td>${t.shift || ""}</td>
            <td>
              <div class="table-actions">
                <button type="button" class="btn-sm" onclick="editTs('${t.id}')">D√ºzenle</button>
              </div>
            </td>
          `;
          tsTableBody.appendChild(tr);
        });
      }
    }

    // ƒ∞zinler
    const leaveTableBody = document.getElementById("leaveTableBody");
    const leaveNoData = document.getElementById("leaveNoData");

    function buildLeaveChain(l) {
      const emp = employees.find(e => e.id === l.empId);
      if (!emp) return "";
      return [
        emp.baƒülƒ±M√ºhendisEmail ? "M√ºhendis: " + emp.baƒülƒ±M√ºhendisEmail : "",
        emp.baƒülƒ±M√ºd√ºrEmail ? "M√ºd√ºr: " + emp.baƒülƒ±M√ºd√ºrEmail : "",
        emp.baƒülƒ±ƒ∞kEmail ? "ƒ∞K: " + emp.baƒülƒ±ƒ∞kEmail : "",
      ].filter(Boolean).join(" ‚Ä¢ ");
    }

    function refreshLeavesUI() {
      leaveTableBody.innerHTML = "";
      if (!leaves.length) {
        leaveNoData.style.display = "block";
      } else {
        leaveNoData.style.display = "none";
        leaves.forEach(l => {
          const emp = employees.find(e => e.id === l.empId);
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${emp ? emp.name : "-"}</td>
            <td>${l.type}</td>
            <td>${l.start}</td>
            <td>${l.end}</td>
            <td>${l.days || ""}</td>
            <td>${buildLeaveChain(l)}</td>
            <td>${l.status}</td>
            <td>
              <div class="table-actions">
                <button type="button" class="btn-sm" onclick="editLeave('${l.id}')">D√ºzenle</button>
              </div>
            </td>
          `;
          leaveTableBody.appendChild(tr);
        });
      }
    }

    // Onboarding
    const onbTableBody = document.getElementById("onbTableBody");
    const onbNoData = document.getElementById("onbNoData");
    const onbDetailPanel = document.getElementById("onbDetailPanel");
    const onbTasksContainer = document.getElementById("onbTasksContainer");
    const onbDetailHeader = document.getElementById("onbDetailHeader");

    function defaultTasksFor(type) {
      if (type === "Offboarding") {
        return [
          "≈ûirket zimmetlerinin teslimi",
          "Sistem eri≈üimlerinin kapatƒ±lmasƒ±",
          "√áƒ±kƒ±≈ü m√ºlakatƒ±",
        ];
      }
      return [
        "ƒ∞K evraklarƒ±nƒ±n tamamlanmasƒ±",
        "Eƒüitim & oryantasyon planƒ±",
        "Saha / ofis g√ºvenlik turu",
      ];
    }

    function refreshOnboardingUI() {
      onbTableBody.innerHTML = "";
      if (!onboarding.length) {
        onbNoData.style.display = "block";
        onbDetailPanel.style.display = "none";
      } else {
        onbNoData.style.display = "none";
        onboarding.forEach(o => {
          const emp = employees.find(e => e.id === o.empId);
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${emp ? emp.name : "-"}</td>
            <td>${o.type}</td>
            <td>${o.startDate}</td>
            <td>${o.completedTasks || 0}/${o.tasks.length}</td>
            <td>${o.status}</td>
            <td>
              <div class="table-actions">
                <button type="button" class="btn-sm" onclick="viewOnb('${o.id}')">G√∂ster</button>
              </div>
            </td>
          `;
          onbTableBody.appendChild(tr);
        });
      }
    }

    // ----------------- FORM EVENTLERƒ∞ -----------------
    // Personel form
    const empForm = document.getElementById("employeeForm");
    const empEditIdInput = document.getElementById("empEditId");

    window.editEmployee = function (id) {
      const emp = employees.find(e => e.id === id);
      if (!emp) return;
      document.getElementById("empName").value = emp.name || (emp.firstName + " " + emp.lastName);
      document.getElementById("empDepartment").value = emp.department || "";
      document.getElementById("empPosition").value = emp.position || "";
      document.getElementById("empStatus").value = emp.status || "Aktif";
      empEditIdInput.value = emp.id;
    };

    document.getElementById("btnCancelEmployeeEdit").addEventListener("click", () => {
      empEditIdInput.value = "";
      empForm.reset();
    });

    empForm.addEventListener("submit", e => {
      e.preventDefault();
      const fullName = document.getElementById("empName").value.trim();
      const [firstName, ...rest] = fullName.split(" ");
      const lastName = rest.length ? rest[rest.length - 1] : "";
      const department = document.getElementById("empDepartment").value.trim();
      const position = document.getElementById("empPosition").value.trim();
      const status = document.getElementById("empStatus").value;

      let id = empEditIdInput.value;
      if (id) {
        const idx = employees.findIndex(e => e.id === id);
        if (idx >= 0) {
          employees[idx] = {
            ...employees[idx],
            name: fullName,
            firstName,
            lastName,
            department,
            position,
            status,
          };
        }
      } else {
        id = "emp_" + Date.now();
        const newEmp = {
          id,
          name: fullName,
          firstName,
          lastName,
          email: "",
          role: "Operat√∂r",
          department,
          position,
          status,
          baƒülƒ±M√ºhendisEmail: "",
          baƒülƒ±M√ºd√ºrEmail: "",
          baƒülƒ±ƒ∞kEmail: "",
          username: makeUsername(firstName, lastName || "user"),
          password: makePassword(firstName),
        };
        employees.push(newEmp);
      }

      saveData(STORAGE_KEYS.employees, employees);
      empEditIdInput.value = "";
      empForm.reset();
      refreshEmployeesUI();
      refreshMetrics();
    });

    // Basit performans formu
    const perfForm = document.getElementById("perfForm");
    const perfEditIdInput = document.getElementById("perfEditId");

    window.editPerf = function (id) {
      const p = performance.find(x => x.id === id);
      if (!p) return;
      document.getElementById("perfEmployee").value = p.empId;
      document.getElementById("perfPeriodInput").value = p.period || "";
      document.getElementById("perfScore").value = p.score || "";
      document.getElementById("perfComment").value = p.comment || "";
      perfEditIdInput.value = p.id;
    };

    document.getElementById("btnCancelPerfEdit").addEventListener("click", () => {
      perfEditIdInput.value = "";
      perfForm.reset();
    });

    perfForm.addEventListener("submit", e => {
      e.preventDefault();
      const empId = document.getElementById("perfEmployee").value;
      const period = document.getElementById("perfPeriodInput").value.trim();
      const score = Number(document.getElementById("perfScore").value || 0);
      const comment = document.getElementById("perfComment").value.trim();

      let id = perfEditIdInput.value;
      if (id) {
        const idx = performance.findIndex(p => p.id === id);
        if (idx >= 0) performance[idx] = { ...performance[idx], empId, period, score, comment };
      } else {
        id = "perf_" + Date.now();
        performance.push({ id, empId, period, score, comment });
      }
      saveData(STORAGE_KEYS.performance, performance);
      perfEditIdInput.value = "";
      perfForm.reset();
      refreshPerformanceUI();
    });

    // Puantaj formu
    const tsForm = document.getElementById("timesheetForm");
    const tsEditIdInput = document.getElementById("tsEditId");

    window.editTs = function (id) {
      const t = timesheets.find(x => x.id === id);
      if (!t) return;
      document.getElementById("tsEmployee").value = t.empId;
      document.getElementById("tsDate").value = t.date;
      document.getElementById("tsHours").value = t.hours;
      document.getElementById("tsShift").value = t.shift || "";
      tsEditIdInput.value = t.id;
    };

    document.getElementById("btnCancelTsEdit").addEventListener("click", () => {
      tsEditIdInput.value = "";
      tsForm.reset();
    });

    tsForm.addEventListener("submit", e => {
      e.preventDefault();
      const empId = document.getElementById("tsEmployee").value;
      const date = document.getElementById("tsDate").value;
      const hours = Number(document.getElementById("tsHours").value || 0);
      const shift = document.getElementById("tsShift").value.trim();

      let id = tsEditIdInput.value;
      if (id) {
        const idx = timesheets.findIndex(t => t.id === id);
        if (idx >= 0) timesheets[idx] = { ...timesheets[idx], empId, date, hours, shift };
      } else {
        id = "ts_" + Date.now();
        timesheets.push({ id, empId, date, hours, shift });
      }
      saveData(STORAGE_KEYS.timesheets, timesheets);
      tsEditIdInput.value = "";
      tsForm.reset();
      refreshTimesheetUI();
      refreshMetrics();
    });

    // ƒ∞zin formu
    const leaveForm = document.getElementById("leaveForm");
    const leaveEditIdInput = document.getElementById("leaveEditId");

    window.editLeave = function (id) {
      const l = leaves.find(x => x.id === id);
      if (!l) return;
      document.getElementById("leaveEmployee").value = l.empId;
      document.getElementById("leaveType").value = l.type;
      document.getElementById("leaveStart").value = l.start;
      document.getElementById("leaveEnd").value = l.end;
      document.getElementById("leaveDays").value = l.days || "";
      document.getElementById("leaveEngineer").value = l.engineer || "";
      document.getElementById("leaveManager").value = l.manager || "";
      document.getElementById("leaveStatus").value = l.status;
      document.getElementById("leaveReason").value = l.reason || "";
      document.getElementById("leaveApprover").value = l.approverNote || "";
      leaveEditIdInput.value = l.id;
    };

    document.getElementById("btnCancelLeaveEdit").addEventListener("click", () => {
      leaveEditIdInput.value = "";
      leaveForm.reset();
    });

    leaveForm.addEventListener("submit", e => {
      e.preventDefault();
      const empId = document.getElementById("leaveEmployee").value;
      const type = document.getElementById("leaveType").value;
      const start = document.getElementById("leaveStart").value;
      const end = document.getElementById("leaveEnd").value;
      const days = Number(document.getElementById("leaveDays").value || 0);
      const engineer = document.getElementById("leaveEngineer").value.trim();
      const manager = document.getElementById("leaveManager").value.trim();
      const status = document.getElementById("leaveStatus").value;
      const reason = document.getElementById("leaveReason").value.trim();
      const approverNote = document.getElementById("leaveApprover").value.trim();

      let id = leaveEditIdInput.value;
      if (id) {
        const idx = leaves.findIndex(l => l.id === id);
        if (idx >= 0) {
          leaves[idx] = { ...leaves[idx], empId, type, start, end, days, engineer, manager, status, reason, approverNote };
        }
      } else {
        id = "lv_" + Date.now();
        leaves.push({ id, empId, type, start, end, days, engineer, manager, status, reason, approverNote });
      }
      saveData(STORAGE_KEYS.leaves, leaves);
      leaveEditIdInput.value = "";
      leaveForm.reset();
      refreshLeavesUI();
      refreshMetrics();
    });

    // Onboarding formu
    const onbForm = document.getElementById("onbForm");

    window.viewOnb = function (id) {
      const o = onboarding.find(x => x.id === id);
      if (!o) return;
      const emp = employees.find(e => e.id === o.empId);
      onbDetailHeader.textContent = (emp ? emp.name : "-") + " | " + o.type + " | Ba≈ülangƒ±√ß: " + o.startDate;
      onbTasksContainer.innerHTML = "";
      o.tasks.forEach((t, idx) => {
        const div = document.createElement("div");
        div.className = "checklist-item";
        const checked = o.completedIndexes.includes(idx);
        div.innerHTML = `
          <input type="checkbox" ${checked ? "checked" : ""} onchange="toggleOnbTask('${o.id}', ${idx}, this.checked)" />
          <span>${t}</span>
        `;
        onbTasksContainer.appendChild(div);
      });
      onbDetailPanel.style.display = "block";
    };

    window.toggleOnbTask = function (onbId, idx, isChecked) {
      const o = onboarding.find(x => x.id === onbId);
      if (!o) return;
      if (isChecked) {
        if (!o.completedIndexes.includes(idx)) o.completedIndexes.push(idx);
      } else {
        o.completedIndexes = o.completedIndexes.filter(i => i !== idx);
      }
      o.completedTasks = o.completedIndexes.length;
      o.status = (o.completedTasks === o.tasks.length) ? "Tamamlandƒ±" : "Devam Ediyor";
      saveData(STORAGE_KEYS.onboarding, onboarding);
      refreshOnboardingUI();
      viewOnb(onbId);
    };

    onbForm.addEventListener("submit", e => {
      e.preventDefault();
      const empId = document.getElementById("onbEmployee").value;
      const type = document.getElementById("onbType").value;
      const startDate = document.getElementById("onbStartDate").value;
      const owner = document.getElementById("onbOwner").value.trim();
      const notes = document.getElementById("onbNotes").value.trim();

      const tasks = defaultTasksFor(type);
      const id = "onb_" + Date.now();
      onboarding.push({
        id,
        empId,
        type,
        startDate,
        owner,
        notes,
        tasks,
        completedIndexes: [],
        completedTasks: 0,
        status: "Devam Ediyor",
      });
      saveData(STORAGE_KEYS.onboarding, onboarding);
      onbForm.reset();
      refreshOnboardingUI();
    });

    // Ayarlar kaydet
    document.getElementById("btnSaveSettings").addEventListener("click", () => {
      settings.companyName = document.getElementById("cfgCompanyName").value.trim();
      settings.defaultDailyHours = Number(document.getElementById("cfgDefaultDailyHours").value || 8);
      settings.perfPeriod = document.getElementById("cfgPerfPeriod").value.trim();
      settings.demoMode = document.getElementById("cfgDemoMode").value;
      settings.performancePeriods.initialEnd = document.getElementById("cfgPerfInitialEnd").value;
      settings.performancePeriods.midEnd = document.getElementById("cfgPerfMidEnd").value;
      settings.performancePeriods.yearEnd = document.getElementById("cfgPerfYearEnd").value;
      saveData(STORAGE_KEYS.settings, settings);
      alert("Ayarlar kaydedildi (localStorage).");
    });

    // Dummy export
    document.getElementById("btnExportDummy").addEventListener("click", () => {
      alert("Demo: Burada JSON ‚Üí Excel/PDF aktarƒ±mƒ± yapƒ±lacak.");
    });

    // Genel refresh
    function refreshAllUI() {
      ensureSeedEmployees();
      refreshEmployeesUI();
      refreshPerformanceUI();
      refreshTimesheetUI();
      refreshLeavesUI();
      refreshOnboardingUI();
      refreshMetrics();

      // Ayar alanlarƒ± doldur
      document.getElementById("cfgCompanyName").value = settings.companyName || "";
      document.getElementById("cfgDefaultDailyHours").value = settings.defaultDailyHours || "";
      document.getElementById("cfgPerfPeriod").value = settings.perfPeriod || "";
      document.getElementById("cfgDemoMode").value = settings.demoMode || "on";
      document.getElementById("cfgPerfInitialEnd").value = settings.performancePeriods.initialEnd || "";
      document.getElementById("cfgPerfMidEnd").value = settings.performancePeriods.midEnd || "";
      document.getElementById("cfgPerfYearEnd").value = settings.performancePeriods.yearEnd || "";
    }

    // Sayfa a√ßƒ±lƒ±≈üƒ±nda sadece seed veriyi hazƒ±rla (login olmadan metrik basmayalƒ±m)
    ensureSeedEmployees();
  </script>
</body>
</html>
