<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>HR Suite - Personel Performans & ƒ∞K Y√∂netimi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f4f5fb;
      --sidebar-bg: #111827;
      --primary: #2563eb;
      --primary-soft: #dbeafe;
      --danger: #ef4444;
      --success: #16a34a;
      --text-main: #111827;
      --text-soft: #6b7280;
      --card-bg: #ffffff;
      --border-soft: #e5e7eb;
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    /* LOGIN WRAPPER */
    .login-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 32px 16px;
    }

    .login-card {
      background: #0b1220;
      border-radius: 24px;
      display: grid;
      grid-template-columns: minmax(0, 320px) minmax(0, 360px);
      max-width: 800px;
      width: 100%;
      overflow: hidden;
      color: #e5e7eb;
      box-shadow: 0 20px 45px rgba(15, 23, 42, 0.45);
    }

    @media (max-width: 768px) {
      .login-card {
        grid-template-columns: minmax(0, 1fr);
      }
      .login-visual {
        display: none;
      }
    }

    .login-visual {
      padding: 32px 28px;
      background: radial-gradient(circle at top, #1d4ed8, #020617);
      position: relative;
      overflow: hidden;
    }

    .login-visual h1 {
      font-size: 26px;
      margin-bottom: 8px;
    }
    .login-visual p {
      font-size: 14px;
      color: #9ca3af;
      max-width: 260px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid rgba(148, 163, 184, 0.3);
      font-size: 11px;
      margin-bottom: 16px;
    }

    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.35);
    }

    .orbit {
      position: absolute;
      width: 260px;
      height: 260px;
      border-radius: 50%;
      border: 1px dashed rgba(148, 163, 184, 0.35);
      top: 48%;
      right: -60px;
      transform: translateY(-50%);
    }

    .orbit-dot {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #38bdf8;
      top: 10%;
      left: 20%;
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.8);
    }

    .login-form-side {
      background: #f9fafb;
      color: #111827;
      padding: 32px 28px;
    }

    .login-form-side h2 {
      font-size: 20px;
      margin-bottom: 6px;
    }

    .login-form-side p {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 24px;
    }

    .field {
      margin-bottom: 16px;
    }

    .field label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #374151;
    }

    .field input,
    .field select,
    .field textarea {
      width: 100%;
      padding: 9px 11px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 13px;
      outline: none;
      transition: 0.15s border, 0.15s box-shadow, 0.15s background;
      background: #ffffff;
      resize: vertical;
    }

    .field input:focus,
    .field select:focus,
    .field textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.25);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 9px 14px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: 0.18s transform, 0.18s box-shadow, 0.18s background-color;
    }

    .btn-primary {
      background: linear-gradient(to right, #2563eb, #4f46e5);
      color: #ffffff;
      box-shadow: 0 12px 25px rgba(37, 99, 235, 0.5);
      width: 100%;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 35px rgba(37, 99, 235, 0.7);
    }

    .helper-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .helper-row span {
      font-size: 12px;
      color: #6b7280;
    }

    .checkbox-inline {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #4b5563;
    }

    .checkbox-inline input {
      width: 14px;
      height: 14px;
    }

    .tiny-note {
      margin-top: 8px;
      font-size: 11px;
      color: #9ca3af;
    }

    .error-text {
      font-size: 12px;
      color: var(--danger);
      margin-bottom: 8px;
      display: none;
    }

    /* APP LAYOUT */
    .app {
      display: none;
      width: 100%;
      min-height: 100vh;
    }

    .app-layout {
      display: grid;
      grid-template-columns: 240px minmax(0, 1fr);
      width: 100%;
      min-height: 100vh;
    }

    @media (max-width: 900px) {
      .app-layout {
        grid-template-columns: 0 minmax(0, 1fr);
      }
      .sidebar {
        position: fixed;
        inset: 0 auto 0 0;
        width: 220px;
        transform: translateX(-100%);
        transition: 0.25s transform;
        z-index: 40;
      }
      .sidebar.open {
        transform: translateX(0);
      }
      .sidebar-overlay {
        display: block;
      }
      .topbar-menu-btn {
        display: inline-flex;
      }
    }

    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      z-index: 30;
    }

    .sidebar {
      background: var(--sidebar-bg);
      color: #e5e7eb;
      padding: 18px 16px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .logo-mark {
      width: 26px;
      height: 26px;
      border-radius: 10px;
      background: radial-gradient(circle at top, #60a5fa, #1d4ed8);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 700;
      color: #eff6ff;
    }

    .logo-title {
      font-size: 15px;
      font-weight: 600;
    }

    .sidebar-section-label {
      font-size: 11px;
      text-transform: uppercase;
      color: #6b7280;
      letter-spacing: 0.08em;
      margin: 10px 0 4px;
    }

    .nav {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 9px;
      border-radius: 10px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 13px;
      text-align: left;
      cursor: pointer;
      transition: 0.16s background, 0.16s color, 0.16s transform;
    }

    .nav-btn span.icon {
      font-size: 14px;
      width: 18px;
      text-align: center;
    }

    .nav-btn.active {
      background: rgba(37, 99, 235, 0.18);
      color: #e5e7eb;
    }

    .nav-btn:hover {
      background: rgba(55, 65, 81, 0.7);
      transform: translateY(-1px);
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 11px;
      color: #6b7280;
    }

    .sidebar-footer strong {
      color: #e5e7eb;
    }

    .main {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .topbar {
      background: #ffffff;
      border-bottom: 1px solid var(--border-soft);
      padding: 10px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .topbar-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .topbar-title {
      font-size: 17px;
      font-weight: 600;
    }

    .topbar-subtitle {
      font-size: 12px;
      color: var(--text-soft);
    }

    .topbar-menu-btn {
      display: none;
      border-radius: 999px;
      border: none;
      padding: 6px 9px;
      background: #e5e7eb;
      cursor: pointer;
      font-size: 15px;
    }

    .topbar-right {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .chip-role {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--primary-soft);
      color: var(--primary);
      border: 1px solid #bfdbfe;
    }

    .user-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .user-avatar {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: linear-gradient(to bottom right, #2563eb, #4f46e5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #eff6ff;
      font-size: 14px;
      font-weight: 600;
    }

    .user-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .user-meta small {
      font-size: 11px;
      color: var(--text-soft);
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 6px 10px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      cursor: pointer;
    }

    .content {
      padding: 16px 18px 24px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .cards-row {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }

    @media (max-width: 1100px) {
      .cards-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .cards-row {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 12px 14px;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.04);
      border: 1px solid #e5e7eb;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 13px;
      color: var(--text-soft);
    }

    .card-value {
      font-size: 20px;
      font-weight: 600;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .tag-success {
      background: #ecfdf3;
      color: #15803d;
    }

    .tag-danger {
      background: #fef2f2;
      color: #b91c1c;
    }

    .section {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 14px 16px;
      border: 1px solid var(--border-soft);
      display: none;
      flex-direction: column;
      gap: 10px;
    }

    .section.active {
      display: flex;
    }

    .section-header {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .section-header h3 {
      font-size: 16px;
      margin-bottom: 2px;
    }

    .section-header p {
      font-size: 12px;
      color: var(--text-soft);
    }

    .filters-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filters-row select,
    .filters-row input {
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      font-size: 12px;
      background: #f9fafb;
    }

    .btn-sm {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #f9fafb;
      cursor: pointer;
    }

    .btn-sm.primary {
      background: var(--primary);
      color: #ffffff;
      border-color: transparent;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 6px;
    }

    th,
    td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
      vertical-align: middle;
    }

    th {
      background: #f9fafb;
      font-weight: 500;
      color: #4b5563;
    }

    tr:hover td {
      background: #f9fafb;
    }

    .table-actions {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 3px 7px;
      border-radius: 999px;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .badge-pill {
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      color: #4b5563;
    }

    .badge-success {
      background: #ecfdf3;
      color: #15803d;
      border-color: #bbf7d0;
    }

    .badge-warning {
      background: #fffbeb;
      color: #92400e;
      border-color: #facc15;
    }

    .badge-danger {
      background: #fef2f2;
      color: #b91c1c;
      border-color: #fecaca;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      margin-top: 8px;
      margin-bottom: 4px;
    }

    @media (max-width: 1100px) {
      .form-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (max-width: 640px) {
      .form-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .form-grid .field label {
      font-size: 11px;
      margin-bottom: 4px;
    }

    .form-grid .field input,
    .form-grid .field select,
    .form-grid .field textarea {
      font-size: 12px;
      padding: 7px 9px;
      border-radius: 8px;
    }

    .divider {
      border-top: 1px dashed #e5e7eb;
      margin: 6px 0;
    }

    .text-right {
      text-align: right;
    }

    .muted {
      color: var(--text-soft);
    }

    .mt-4 { margin-top: 4px; }
    .mt-8 { margin-top: 8px; }

    .no-data {
      font-size: 12px;
      color: var(--text-soft);
      padding: 4px 0;
    }

    .subtitle-small {
      font-size: 11px;
      color: var(--text-soft);
    }

    .pill-stage {
      padding: 3px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 11px;
    }

    .subsection-title {
      font-size: 13px;
      font-weight: 600;
      margin-top: 6px;
      margin-bottom: 2px;
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      margin-bottom: 4px;
    }

    .checklist-item input {
      width: 14px;
      height: 14px;
    }
  </style>
</head>
<body>
  <!-- LOGIN SCREEN -->
  <div class="login-wrapper" id="loginView">
    <div class="login-card">
      <div class="login-visual">
        <div class="pill">
          <span class="pill-dot"></span>
          Ger√ßek zamanlƒ± performans & puantaj takibi
        </div>
        <h1>HR Suite</h1>
        <p>
          Personel performansƒ±, puantaj, izin ve onboarding/offboarding
          s√ºre√ßlerinizi tek ekrandan y√∂netin.
        </p>
        <div class="orbit">
          <div class="orbit-dot"></div>
        </div>
      </div>
      <div class="login-form-side">
        <h2>Y√∂netici / Kullanƒ±cƒ± Giri≈üi</h2>
        <p>Sisteme giri≈ü yaparak t√ºm ƒ∞K ve performans mod√ºllerine eri≈üin.</p>
        <div id="loginError" class="error-text">
          Kullanƒ±cƒ± adƒ± veya ≈üifre hatalƒ±.
        </div>
        <div class="field">
          <label for="username">Kullanƒ±cƒ± Adƒ±</label>
          <input id="username" type="text" placeholder="√∂r: remzican.ergin" />
        </div>
        <div class="field">
          <label for="password">≈ûifre</label>
          <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        </div>
        <div class="helper-row">
          <label class="checkbox-inline">
            <input type="checkbox" id="rememberMe" /> Beni hatƒ±rla
          </label>
          <span>√ñrnek: <strong>remzican.ergin / Remzi123</strong></span>
        </div>
        <button class="btn btn-primary" id="loginBtn">
          Sisteme Giri≈ü Yap
        </button>
        <div class="tiny-note">
          Bu ekran sadece demo ama√ßlƒ±dƒ±r, ger√ßek bir ≈üifre y√∂netimi veya LDAP entegrasyonu i√ßermez.
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div class="app" id="appView">
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="app-layout">
      <aside class="sidebar" id="sidebar">
        <div>
          <div class="logo">
            <div class="logo-mark">HR</div>
            <div>
              <div class="logo-title">HR Suite</div>
              <div style="font-size: 11px; color: #6b7280">
                Performans & ƒ∞K Y√∂netimi
              </div>
            </div>
          </div>
          <div class="sidebar-section-label">Genel</div>
          <div class="nav">
            <button class="nav-btn active" data-section="dashboard">
              <span class="icon">üìä</span> Dashboard
            </button>
            <button class="nav-btn" data-section="employees">
              <span class="icon">üë•</span> Personeller
            </button>
            <button class="nav-btn" data-section="performance">
              <span class="icon">‚≠ê</span> Performans
            </button>
            <button class="nav-btn" data-section="timesheet">
              <span class="icon">‚è±</span> Puantaj / √áalƒ±≈üma Saatleri
            </button>
            <button class="nav-btn" data-section="leave">
              <span class="icon">üèù</span> ƒ∞zin Talepleri
            </button>
            <button class="nav-btn" data-section="onboarding">
              <span class="icon">üß©</span> Onboarding / Offboarding
            </button>
          </div>

          <div class="sidebar-section-label">Y√∂netim</div>
          <div class="nav">
            <button class="nav-btn" data-section="reports">
              <span class="icon">üìë</span> Raporlar
            </button>
            <button class="nav-btn" data-section="settings">
              <span class="icon">‚öôÔ∏è</span> Ayarlar
            </button>
          </div>
        </div>
        <div class="sidebar-footer">
          <div>Baƒülƒ± birim: <strong>ƒ∞≈ületme & ƒ∞K</strong></div>
          <div>S√ºr√ºm: v0.3 demo</div>
        </div>
      </aside>

      <main class="main">
        <header class="topbar">
          <div class="topbar-left">
            <button class="topbar-menu-btn" id="topbarMenuBtn">‚ò∞</button>
            <div>
              <div class="topbar-title">HR Suite Dashboard</div>
              <div class="topbar-subtitle">
                Personel performansƒ±, puantaj, izin ve onboarding s√ºre√ßleri tek ekranda.
              </div>
            </div>
          </div>
          <div class="topbar-right">
            <span class="chip-role" id="chipRole">Rol: -</span>
            <button class="btn-ghost" id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
            <div class="user-badge" id="userBadge">
              <div class="user-avatar" id="userAvatar">US</div>
              <div class="user-meta">
                <span id="userNameLabel">Kullanƒ±cƒ±</span>
                <small>Baƒülƒ± Birim</small>
              </div>
            </div>
          </div>
        </header>

        <section class="content">
          <!-- METRIC CARDS -->
          <div class="cards-row">
            <div class="card" id="metricEmployees">
              <div class="card-header">
                <span class="card-title">Toplam Personel</span>
                <span class="tag">Aktif</span>
              </div>
              <div class="card-value" id="metricTotalEmployees">0</div>
              <div class="mt-4 muted" id="metricEmployeesDetail"></div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Aktif Performans Formu</span>
                <span class="tag tag-success">Devam Ediyor</span>
              </div>
              <div class="card-value" id="metricActiveReviews">0</div>
              <div class="mt-4 muted">
                A√ßƒ±k durumdaki performans puan / formlarƒ±.
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Bug√ºnk√º Puantaj</span>
                <span class="tag">G√ºnl√ºk</span>
              </div>
              <div class="card-value" id="metricTodayHours">0 sa</div>
              <div class="mt-4 muted" id="metricTodayDetail"></div>
            </div>
            <div class="card">
              <div class="card-header">
                <span class="card-title">Bekleyen ƒ∞zin Talebi</span>
                <span class="tag tag-danger">Onay Bekliyor</span>
              </div>
              <div class="card-value" id="metricPendingLeaves">0</div>
              <div class="mt-4 muted">
                M√ºhendis / M√ºd√ºr onayƒ± bekleyen talepler.
              </div>
            </div>
          </div>

          <!-- DASHBOARD SECTION -->
          <div class="section active" id="section-dashboard">
            <div class="section-header">
              <div>
                <h3>Genel Bakƒ±≈ü</h3>
                <p>ƒ∞K, performans ve operasyon metriklerinin √∂zeti.</p>
              </div>
              <div class="filters-row">
                <select id="dashboardPeriod">
                  <option value="month">Bu Ay</option>
                  <option value="quarter">Bu √áeyrek</option>
                  <option value="year">Bu Yƒ±l</option>
                </select>
                <button class="btn-sm" id="btnRefreshDashboard">Yenile</button>
              </div>
            </div>
            <div class="divider"></div>
            <div class="mt-4 muted">
              Demo versiyonda grafik yerine metrik kartlarƒ± g√∂sterilmektedir.
              Ger√ßek projede Chart.js vb. eklenebilir.
            </div>
          </div>

          <!-- EMPLOYEES SECTION -->
          <div class="section" id="section-employees">
            <div class="section-header">
              <div>
                <h3>Personel Y√∂netimi</h3>
                <p>Personel ekleyin, g√ºncelleyin ve durumlarƒ±nƒ± y√∂netin.</p>
              </div>
              <div class="filters-row">
                <input type="text" id="employeeSearch" placeholder="ƒ∞sim / departman ara..." />
                <select id="employeeFilterStatus">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Aktif">Aktif</option>
                  <option value="Pasif">Pasif</option>
                </select>
                <button class="btn-sm primary" id="btnAddEmployee">+ Yeni Personel</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="employeeForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Ad Soyad</label>
                  <input type="text" id="empName" placeholder="√ñrn: Ali Yƒ±lmaz" required />
                </div>
                <div class="field">
                  <label>Departman</label>
                  <input type="text" id="empDepartment" placeholder="√ñrn: Operasyon" />
                </div>
                <div class="field">
                  <label>Pozisyon</label>
                  <input type="text" id="empPosition" placeholder="√ñrn: Saha Operat√∂r√º" />
                </div>
                <div class="field">
                  <label>Durum</label>
                  <select id="empStatus">
                    <option value="Aktif">Aktif</option>
                    <option value="Pasif">Pasif</option>
                  </select>
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>Baƒülƒ± M√ºhendis</label>
                  <input type="text" id="empEngineer" placeholder="√ñrn: Saha M√ºhendisi" />
                </div>
                <div class="field">
                  <label>Baƒülƒ± M√ºd√ºr</label>
                  <input type="text" id="empManager" placeholder="√ñrn: Operasyon M√ºd√ºr√º" />
                </div>
                <div class="field">
                  <label>ƒ∞K Sorumlusu</label>
                  <input type="text" id="empHrOwner" placeholder="√ñrn: ƒ∞K Uzmanƒ±" />
                </div>
                <div class="field">
                  <label>Rol</label>
                  <select id="empRole">
                    <option value="">Se√ßiniz</option>
                    <option value="Operat√∂r">Operat√∂r</option>
                    <option value="M√ºhendis">M√ºhendis</option>
                    <option value="M√ºd√ºr">M√ºd√ºr</option>
                    <option value="IK">ƒ∞K</option>
                  </select>
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelEmployeeEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="empEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Ad Soyad</th>
                    <th>Departman</th>
                    <th>Pozisyon</th>
                    <th>Durum</th>
                    <th>Baƒülƒ± M√ºhendis</th>
                    <th>Baƒülƒ± M√ºd√ºr</th>
                    <th>ƒ∞K Sorumlusu</th>
                    <th>Rol</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="employeeTableBody"></tbody>
              </table>
              <div id="employeeNoData" class="no-data" style="display:none">
                Hen√ºz personel eklenmemi≈ü.
              </div>
            </div>
          </div>

          <!-- PERFORMANCE SECTION -->
          <div class="section" id="section-performance">
            <div class="section-header">
              <div>
                <h3>Performans Y√∂netimi</h3>
                <p>Basit puan kayƒ±tlarƒ± ve Rafineri & Terminal M√ºhendislik performans formu.</p>
              </div>
              <div class="filters-row">
                <select id="perfPeriod">
                  <option value="2025Q1">2025 Q1</option>
                  <option value="2025Q2">2025 Q2</option>
                  <option value="2025Q3">2025 Q3</option>
                  <option value="2025Q4" selected>2025 Q4</option>
                </select>
                <button class="btn-sm primary" id="btnAddPerf">+ Basit Performans Kaydƒ±</button>
              </div>
            </div>
            <div class="divider"></div>

            <!-- Basit skor formu -->
            <form id="perfForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="perfEmployee"></select>
                </div>
                <div class="field">
                  <label>D√∂nem</label>
                  <input type="text" id="perfPeriodInput" placeholder="2025 Q4" />
                </div>
                <div class="field">
                  <label>Genel Puan (0-100)</label>
                  <input type="number" id="perfScore" min="0" max="100" placeholder="√∂r: 87" />
                </div>
                <div class="field">
                  <label>Yorum</label>
                  <input type="text" id="perfComment" placeholder="√ñrn: Hedefleri %95 oranƒ±nda tamamladƒ±." />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelPerfEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="perfEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>D√∂nem</th>
                    <th>Puan</th>
                    <th>Yorum</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="perfTableBody"></tbody>
              </table>
              <div id="perfNoData" class="no-data" style="display:none">
                Hen√ºz performans kaydƒ± eklenmemi≈ü.
              </div>
            </div>

            <div class="divider"></div>

            <!-- Rafineri & Terminal M√ºhendislik Performans Formu -->
            <div class="mt-4">
              <div class="subsection-title">
                Rafineri & Terminal M√ºhendislik Performans Formlarƒ±
              </div>
              <div class="subtitle-small">
                SAP SuccessFactors mantƒ±ƒüƒ±nda: Form ‚Üí Ara Deƒüerlendirme ‚Üí Yƒ±l Sonu (Personel / Y√∂netici / ƒ∞K akƒ±≈üƒ±)
              </div>
            </div>

            <form id="perf2CreateForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="perf2Employee"></select>
                </div>
                <div class="field">
                  <label>Yƒ±l</label>
                  <input type="number" id="perf2Year" placeholder="2025" />
                </div>
                <div class="field">
                  <label>Rol / Kapsam</label>
                  <input type="text" id="perf2Role" value="M√ºhendislik - Rafineri & Terminal" />
                </div>
                <div class="field">
                  <label>Form A√ßƒ±klamasƒ±</label>
                  <input type="text" id="perf2Desc" placeholder="√ñrn: 2025 M√ºhendislik Performans Formu" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>KPI - ƒ∞≈ü G√ºvenliƒüi & HSSE</label>
                  <input type="text" id="perf2KpiSafety" placeholder="√ñrn: SIF sƒ±fƒ±r kaza, PTW uyumu..." />
                </div>
                <div class="field">
                  <label>KPI - Operasyon & S√ºre√ß</label>
                  <input type="text" id="perf2KpiOps" placeholder="√ñrn: Tank devreye alma, arƒ±za y√∂netimi..." />
                </div>
                <div class="field">
                  <label>KPI - Projeler & ƒ∞yile≈ütirme</label>
                  <input type="text" id="perf2KpiProjects" placeholder="√ñrn: CAPEX projelerine katkƒ±..." />
                </div>
                <div class="field">
                  <label>KPI - Liderlik & Takƒ±m √áalƒ±≈ümasƒ±</label>
                  <input type="text" id="perf2KpiLeadership" placeholder="√ñrn: Ekip ko√ßluƒüu, devreye alma liderliƒüi..." />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="submit" class="btn-sm primary">+ Performans Formu Olu≈ütur</button>
              </div>
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Yƒ±l</th>
                    <th>Rol</th>
                    <th>A≈üama</th>
                    <th>Ara Ort.</th>
                    <th>Yƒ±l Sonu Ort.</th>
                    <th>Final Puan</th>
                    <th style="width: 140px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="perf2TableBody"></tbody>
              </table>
              <div id="perf2NoData" class="no-data" style="display:none">
                Hen√ºz m√ºhendislik performans formu olu≈üturulmamƒ±≈ü.
              </div>
            </div>

            <div id="perf2DetailPanel" class="mt-8" style="display:none;">
              <div class="subsection-title">Se√ßili Form Detayƒ±</div>
              <div class="muted" id="perf2DetailHeader"></div>
              <input type="hidden" id="perf2DetailId" value="" />

              <div class="mt-4">
                <span class="subtitle-small">A≈üama:</span>
                <span class="pill-stage" id="perf2StageLabel"></span>
              </div>

              <div class="subsection-title">1) ƒ∞lk Form (Personel ‚Üí Y√∂netici ‚Üí ƒ∞K)</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2InitEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2InitMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2InitHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2InitNote" placeholder="ƒ∞lk form notlarƒ±" />
                </div>
              </div>

              <div class="subsection-title">2) Ara D√∂nem Deƒüerlendirme</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2MidEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2MidMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2MidHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2MidNote" placeholder="Ara d√∂nem notlarƒ±" />
                </div>
              </div>

              <div class="subsection-title">3) Yƒ±l Sonu Deƒüerlendirme</div>
              <div class="form-grid">
                <div class="field">
                  <label>Personel Puanƒ±</label>
                  <input type="number" id="perf2YearEmp" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Y√∂netici Puanƒ±</label>
                  <input type="number" id="perf2YearMgr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>ƒ∞K Puanƒ±</label>
                  <input type="number" id="perf2YearHr" min="0" max="100" placeholder="0-100" />
                </div>
                <div class="field">
                  <label>Not</label>
                  <input type="text" id="perf2YearNote" placeholder="Yƒ±l sonu notlarƒ±" />
                </div>
              </div>

              <div class="mt-4 subtitle-small" id="perf2SummaryText"></div>

              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnPerf2Advance">A≈üamayƒ± ƒ∞lerle (Demo)</button>
                <button type="button" class="btn-sm primary" id="btnPerf2Save">Formu Kaydet</button>
              </div>

              <div class="tiny-note">
                Ger√ßek sistemde bu a≈üamalar rol bazlƒ± (Personel / Y√∂netici / ƒ∞K) login ile
                kƒ±sƒ±tlanabilir. Burada t√ºm alanlar admin tarafƒ±ndan g√∂r√ºlebilen demo ama√ßlƒ±dƒ±r.
              </div>
            </div>
          </div>

          <!-- TIMESHEET SECTION -->
          <div class="section" id="section-timesheet">
            <div class="section-header">
              <div>
                <h3>Puantaj / √áalƒ±≈üma Saatleri</h3>
                <p>Vardiya ve g√ºnl√ºk √ßalƒ±≈üma saatlerini y√∂netin.</p>
              </div>
              <div class="filters-row">
                <input type="month" id="timesheetMonth" />
                <select id="timesheetEmployeeFilter"></select>
                <button class="btn-sm primary" id="btnAddTimesheet">+ Kayƒ±t Ekle</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="timesheetForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="tsEmployee"></select>
                </div>
                <div class="field">
                  <label>Tarih</label>
                  <input type="date" id="tsDate" />
                </div>
                <div class="field">
                  <label>Toplam Saat</label>
                  <input type="number" id="tsHours" step="0.5" min="0" max="24" placeholder="√∂r: 8" />
                </div>
                <div class="field">
                  <label>Vardiya</label>
                  <input type="text" id="tsShift" placeholder="√ñrn: G√ºnd√ºz" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelTsEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="tsEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Tarih</th>
                    <th>Saat</th>
                    <th>Vardiya</th>
                    <th style="width: 120px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="tsTableBody"></tbody>
              </table>
              <div id="tsNoData" class="no-data" style="display:none">
                Hen√ºz puantaj kaydƒ± eklenmemi≈ü.
              </div>
            </div>
          </div>

          <!-- LEAVE SECTION -->
          <div class="section" id="section-leave">
            <div class="section-header">
              <div>
                <h3>ƒ∞zin Talepleri</h3>
                <p>Yƒ±llƒ±k izin, mazeret izni ve √ßok adƒ±mlƒ± onay s√ºre√ßleri.</p>
              </div>
              <div class="filters-row">
                <select id="leaveStatusFilter">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Bekliyor">Bekliyor</option>
                  <option value="Onaylandƒ±">Onaylandƒ±</option>
                  <option value="Reddedildi">Reddedildi</option>
                </select>
                <button class="btn-sm primary" id="btnAddLeave">+ Yeni ƒ∞zin Talebi</button>
              </div>
            </div>
            <div class="divider"></div>

            <form id="leaveForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="leaveEmployee"></select>
                </div>
                <div class="field">
                  <label>ƒ∞zin T√ºr√º</label>
                  <select id="leaveType">
                    <option value="Yƒ±llƒ±k ƒ∞zin">Yƒ±llƒ±k ƒ∞zin</option>
                    <option value="Mazeret ƒ∞zni">Mazeret ƒ∞zni</option>
                    <option value="Hastalƒ±k ƒ∞zni">Hastalƒ±k ƒ∞zni</option>
                    <option value="√úcretsiz ƒ∞zin">√úcretsiz ƒ∞zin</option>
                  </select>
                </div>
                <div class="field">
                  <label>Ba≈ülangƒ±√ß Tarihi</label>
                  <input type="date" id="leaveStart" />
                </div>
                <div class="field">
                  <label>Biti≈ü Tarihi</label>
                  <input type="date" id="leaveEnd" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>G√ºn Sayƒ±sƒ±</label>
                  <input type="number" id="leaveDays" min="0" step="0.5" placeholder="Otomatik veya manuel" />
                </div>
                <div class="field">
                  <label>Baƒülƒ± M√ºhendis</label>
                  <input type="text" id="leaveEngineer" placeholder="√ñrn: Saha M√ºhendisi" />
                </div>
                <div class="field">
                  <label>Departman M√ºd√ºr√º</label>
                  <input type="text" id="leaveManager" placeholder="√ñrn: Operasyon M√ºd√ºr√º" />
                </div>
                <div class="field">
                  <label>Durum</label>
                  <select id="leaveStatus">
                    <option value="Bekliyor">Bekliyor</option>
                    <option value="Onaylandƒ±">Onaylandƒ±</option>
                    <option value="Reddedildi">Reddedildi</option>
                  </select>
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>A√ßƒ±klama</label>
                  <input type="text" id="leaveReason" placeholder="√ñrn: Yƒ±llƒ±k izin planƒ±" />
                </div>
                <div class="field">
                  <label>Onaylayan Notu</label>
                  <input type="text" id="leaveApprover" placeholder="√ñrn: M√ºd√ºr notu" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="button" class="btn-sm" id="btnCancelLeaveEdit">ƒ∞ptal</button>
                <button type="submit" class="btn-sm primary">Kaydet</button>
              </div>
              <input type="hidden" id="leaveEditId" value="" />
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>T√ºr</th>
                    <th>Ba≈ülangƒ±√ß</th>
                    <th>Biti≈ü</th>
                    <th>G√ºn</th>
                    <th>Onay Zinciri</th>
                    <th>Durum</th>
                    <th style="width: 170px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="leaveTableBody"></tbody>
              </table>
              <div id="leaveNoData" class="no-data" style="display:none">
                Hen√ºz izin talebi bulunmuyor.
              </div>
            </div>
          </div>

          <!-- ONBOARDING / OFFBOARDING SECTION -->
          <div class="section" id="section-onboarding">
            <div class="section-header">
              <div>
                <h3>Onboarding / Offboarding</h3>
                <p>Personel katƒ±lƒ±m ve ayrƒ±lƒ±≈ü s√ºre√ßlerini SAP SuccessFactors benzeri takip edin.</p>
              </div>
              <div class="filters-row">
                <select id="onbTypeFilter">
                  <option value="">T√ºm Tipler</option>
                  <option value="Onboarding">Onboarding</option>
                  <option value="Offboarding">Offboarding</option>
                </select>
                <select id="onbStatusFilter">
                  <option value="">T√ºm Durumlar</option>
                  <option value="Devam Ediyor">Devam Ediyor</option>
                  <option value="Tamamlandƒ±">Tamamlandƒ±</option>
                </select>
              </div>
            </div>
            <div class="divider"></div>

            <form id="onbForm" class="mt-4">
              <div class="form-grid">
                <div class="field">
                  <label>Personel</label>
                  <select id="onbEmployee"></select>
                </div>
                <div class="field">
                  <label>S√ºre√ß Tipi</label>
                  <select id="onbType">
                    <option value="Onboarding">Onboarding (Katƒ±lƒ±m)</option>
                    <option value="Offboarding">Offboarding (Ayrƒ±lƒ±≈ü)</option>
                  </select>
                </div>
                <div class="field">
                  <label>Ba≈ülangƒ±√ß Tarihi</label>
                  <input type="date" id="onbStartDate" />
                </div>
                <div class="field">
                  <label>Sorumlu</label>
                  <input type="text" id="onbOwner" placeholder="√ñrn: ƒ∞K Uzmanƒ± / Operasyon ≈ûefi" />
                </div>
              </div>
              <div class="form-grid">
                <div class="field">
                  <label>A√ßƒ±klama</label>
                  <input type="text" id="onbNotes" placeholder="√ñrn: Yeni saha m√ºhendisi onboarding" />
                </div>
              </div>
              <div class="text-right mt-4">
                <button type="submit" class="btn-sm primary">+ S√ºre√ß Olu≈ütur</button>
              </div>
            </form>

            <div class="mt-4">
              <table>
                <thead>
                  <tr>
                    <th>Personel</th>
                    <th>Tip</th>
                    <th>Ba≈ülangƒ±√ß</th>
                    <th>G√∂rev Durumu</th>
                    <th>Durum</th>
                    <th style="width: 150px">ƒ∞≈ülemler</th>
                  </tr>
                </thead>
                <tbody id="onbTableBody"></tbody>
              </table>
              <div id="onbNoData" class="no-data" style="display:none">
                Hen√ºz onboarding / offboarding s√ºreci olu≈üturulmamƒ±≈ü.
              </div>
            </div>

            <div id="onbDetailPanel" class="mt-8" style="display:none;">
              <div class="subsection-title">G√∂rev Checklist</div>
              <div class="muted" id="onbDetailHeader"></div>
              <div id="onbTasksContainer" class="mt-4"></div>
              <div class="tiny-note">
                G√∂revler tamamlandƒ±k√ßa s√ºre√ß durumu otomatik g√ºncellenir. Ger√ßek sistemde bu adƒ±mlar
                ilgili ekipler ve departmanlara g√∂rev olarak daƒüƒ±tƒ±labilir.
              </div>
            </div>
          </div>

          <!-- REPORTS SECTION -->
          <div class="section" id="section-reports">
            <div class="section-header">
              <div>
                <h3>Raporlar</h3>
                <p>Excel / PDF entegrasyonuna hazƒ±r basit rapor ≈üablonlarƒ±.</p>
              </div>
              <div class="filters-row">
                <select id="reportType">
                  <option value="perf">Performans √ñzeti</option>
                  <option value="leave">ƒ∞zin √ñzeti</option>
                  <option value="timesheet">Puantaj √ñzeti</option>
                </select>
                <button class="btn-sm primary" id="btnExportDummy">Excel'e Aktar (Mock)</button>
              </div>
            </div>
            <div class="divider"></div>
            <div class="mt-4 muted">
              Bu demo versiyonda ger√ßek dosya √ºretimi yoktur. Arka tarafta Node.js
              veya Django API ile JSON ‚Üí Excel/PDF d√∂n√º≈üt√ºr√ºp indirme butonuna baƒülayabilirsiniz.
            </div>
          </div>

          <!-- SETTINGS SECTION -->
          <div class="section" id="section-settings">
            <div class="section-header">
              <div>
                <h3>Ayarlar</h3>
                <p>≈ûirket, performans d√∂nemleri ve demo ayarlarƒ±nƒ± y√∂netin.</p>
              </div>
            </div>
            <div class="divider"></div>
            <div class="form-grid mt-4">
              <div class="field">
                <label>≈ûirket Adƒ±</label>
                <input id="cfgCompanyName" type="text" placeholder="√ñrn: ATA≈û" />
              </div>
              <div class="field">
                <label>Varsayƒ±lan √áalƒ±≈üma Saati / G√ºn</label>
                <input id="cfgDefaultDailyHours" type="number" min="1" max="24" step="0.5" placeholder="8" />
              </div>
              <div class="field">
                <label>Performans D√∂nemi</label>
                <input id="cfgPerfPeriod" type="text" placeholder="√ñrn: 2025 Yƒ±llƒ±k" />
              </div>
              <div class="field">
                <label>Demo Modu</label>
                <select id="cfgDemoMode">
                  <option value="on">A√ßƒ±k</option>
                  <option value="off">Kapalƒ±</option>
                </select>
              </div>
            </div>

            <div class="subsection-title mt-8">Performans Formu D√∂nem Son Tarihleri</div>
            <div class="form-grid mt-4">
              <div class="field">
                <label>ƒ∞lk Form Son Tarihi</label>
                <input type="date" id="cfgPerfInitialEnd" />
              </div>
              <div class="field">
                <label>Ara Deƒüerlendirme Son Tarihi</label>
                <input type="date" id="cfgPerfMidEnd" />
              </div>
              <div class="field">
                <label>Yƒ±l Sonu Deƒüerlendirme Son Tarihi</label>
                <input type="date" id="cfgPerfYearEnd" />
              </div>
            </div>

            <div class="text-right mt-4">
              <button class="btn-sm primary" id="btnSaveSettings">Ayarlarƒ± Kaydet</button>
            </div>
            <div class="tiny-note">
              Ayarlar localStorage'a kaydedilir. Ger√ßek projede bu alanlarƒ± backend (PostgreSQL vb.)
              ile kalƒ±cƒ± hale getirip cron job ile 1 hafta / 5 g√ºn / 2 g√ºn √∂nceden e-posta hatƒ±rlatmalarƒ±
              g√∂nderebilirsiniz.
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    // --- STORAGE KEYS ---
    const STORAGE_KEYS = {
      employees: "hrsuite_employees",
      performance: "hrsuite_performance",
      timesheets: "hrsuite_timesheets",
      leaves: "hrsuite_leaves",
      settings: "hrsuite_settings",
      lastUser: "hrsuite_last_user",
      perfForms: "hrsuite_perf_forms",
      onboarding: "hrsuite_onboarding"
    };

    function loadData(key, defaultValue) {
      try {
        const raw = localStorage.getItem(key);
        return raw ? JSON.parse(raw) : defaultValue;
      } catch {
        return defaultValue;
      }
    }

    function saveData(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }

    // Demo e-posta mock
    function sendEmailMock(to, subject, body) {
      console.log("[EMAIL MOCK]", { to, subject, body });
    }

    // --- LOGIN USERS (DEMO) ---
    const LOGIN_USERS = {
      "remzican.ergin": { password: "Remzi123", role: "M√ºhendis", empId: "EMP1" },
      "hasan.demir":     { password: "Hasan123", role: "Operat√∂r", empId: "EMP2" },
      "aytac.celik":     { password: "Aytac123", role: "M√ºd√ºr",    empId: "EMP3" },
      "nesibe.esen":     { password: "Nesibe123", role: "IK",       empId: "EMP4" }
    };

    // --- GLOBAL STATE ---
    let employees = loadData(STORAGE_KEYS.employees, []);
    let performance = loadData(STORAGE_KEYS.performance, []);
    let timesheets = loadData(STORAGE_KEYS.timesheets, []);
    let leaves = loadData(STORAGE_KEYS.leaves, []);
    let perfForms = loadData(STORAGE_KEYS.perfForms, []);
    let onboarding = loadData(STORAGE_KEYS.onboarding, []);
    let settings = loadData(STORAGE_KEYS.settings, {
      companyName: "HR Suite Demo",
      defaultDailyHours: 8,
      perfPeriod: "2025",
      demoMode: "on",
      performancePeriods: { initialEnd: "", midEnd: "", yearEnd: "" }
    });

    let currentUser = null;

    // Seed demo employees if not present
    function ensureSeedEmployees(list) {
      const arr = Array.isArray(list) ? [...list] : [];

      function upsert(id, name, department, position, role, username) {
        let emp = arr.find(e => e.id === id || e.username === username);
        if (!emp) {
          emp = {
            id,
            name,
            department,
            position,
            status: "Aktif",
            reportingEngineer: role === "Operat√∂r" ? "Remzican Ergin" : "",
            reportingManager: "Ayta√ß √áelik",
            hrOwner: "Nesibe Esen",
            role,
            username
          };
          arr.push(emp);
        } else {
          // G√ºncelle temel alanlar
          emp.name = name;
          emp.department = department;
          emp.position = position;
          emp.role = role;
          emp.username = username || emp.username;
          if (!emp.reportingManager) emp.reportingManager = "Ayta√ß √áelik";
          if (!emp.hrOwner) emp.hrOwner = "Nesibe Esen";
        }
      }

      upsert("EMP1", "Remzican Ergin", "Operasyon", "M√ºhendis", "M√ºhendis", "remzican.ergin");
      upsert("EMP2", "Hasan Demir", "Operasyon", "Operat√∂r", "Operat√∂r", "hasan.demir");
      upsert("EMP3", "Ayta√ß √áelik", "Operasyon", "M√ºd√ºr", "M√ºd√ºr", "aytac.celik");
      upsert("EMP4", "Nesibe Esen", "ƒ∞K", "ƒ∞K Uzmanƒ±", "IK", "nesibe.esen");

      saveData(STORAGE_KEYS.employees, arr);
      return arr;
    }

    employees = ensureSeedEmployees(employees);

    // --- DOM REFS: LOGIN ---
    const loginView = document.getElementById("loginView");
    const appView = document.getElementById("appView");
    const loginBtn = document.getElementById("loginBtn");
    const loginError = document.getElementById("loginError");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    const rememberMe = document.getElementById("rememberMe");

    const lastUser = loadData(STORAGE_KEYS.lastUser, null);
    if (lastUser && lastUser.username) {
      usernameInput.value = lastUser.username;
      rememberMe.checked = true;
    }

    // --- DOM REFS: LAYOUT ---
    const sidebar = document.getElementById("sidebar");
    const sidebarOverlay = document.getElementById("sidebarOverlay");
    const topbarMenuBtn = document.getElementById("topbarMenuBtn");
    const navButtons = document.querySelectorAll(".nav-btn");

    const sections = {
      dashboard: document.getElementById("section-dashboard"),
      employees: document.getElementById("section-employees"),
      performance: document.getElementById("section-performance"),
      timesheet: document.getElementById("section-timesheet"),
      leave: document.getElementById("section-leave"),
      onboarding: document.getElementById("section-onboarding"),
      reports: document.getElementById("section-reports"),
      settings: document.getElementById("section-settings")
    };

    const userNameLabel = document.getElementById("userNameLabel");
    const userAvatar = document.getElementById("userAvatar");
    const chipRole = document.getElementById("chipRole");

    // --- ROLE PERMISSIONS ---
    const SECTION_PERMISSIONS = {
      dashboard: ["Operat√∂r", "M√ºhendis", "M√ºd√ºr", "IK"],
      employees: ["IK"],
      performance: ["M√ºhendis", "M√ºd√ºr", "IK"],
      timesheet: ["M√ºd√ºr", "IK"],
      leave: ["Operat√∂r", "M√ºhendis", "M√ºd√ºr", "IK"],
      onboarding: ["M√ºd√ºr", "IK"],
      reports: ["IK"],
      settings: ["IK"]
    };

    // --- METRIC REFS ---
    const metricTotalEmployees = document.getElementById("metricTotalEmployees");
    const metricEmployeesDetail = document.getElementById("metricEmployeesDetail");
    const metricActiveReviews = document.getElementById("metricActiveReviews");
    const metricTodayHours = document.getElementById("metricTodayHours");
    const metricTodayDetail = document.getElementById("metricTodayDetail");
    const metricPendingLeaves = document.getElementById("metricPendingLeaves");

    // --- EMP REFS ---
    const employeeTableBody = document.getElementById("employeeTableBody");
    const employeeNoData = document.getElementById("employeeNoData");
    const empName = document.getElementById("empName");
    const empDepartment = document.getElementById("empDepartment");
    const empPosition = document.getElementById("empPosition");
    const empStatus = document.getElementById("empStatus");
    const empEngineer = document.getElementById("empEngineer");
    const empManager = document.getElementById("empManager");
    const empHrOwner = document.getElementById("empHrOwner");
    const empRole = document.getElementById("empRole");
    const empEditId = document.getElementById("empEditId");
    const employeeForm = document.getElementById("employeeForm");
    const btnCancelEmployeeEdit = document.getElementById("btnCancelEmployeeEdit");
    const employeeSearch = document.getElementById("employeeSearch");
    const employeeFilterStatus = document.getElementById("employeeFilterStatus");
    const btnAddEmployee = document.getElementById("btnAddEmployee");

    // --- PERF REFS ---
    const perfEmployee = document.getElementById("perfEmployee");
    const perfPeriodInput = document.getElementById("perfPeriodInput");
    const perfScore = document.getElementById("perfScore");
    const perfComment = document.getElementById("perfComment");
    const perfEditId = document.getElementById("perfEditId");
    const perfForm = document.getElementById("perfForm");
    const perfTableBody = document.getElementById("perfTableBody");
    const perfNoData = document.getElementById("perfNoData");
    const btnCancelPerfEdit = document.getElementById("btnCancelPerfEdit");

    // Perf2 (m√ºhendislik formu)
    const perf2Employee = document.getElementById("perf2Employee");
    const perf2Year = document.getElementById("perf2Year");
    const perf2Role = document.getElementById("perf2Role");
    const perf2Desc = document.getElementById("perf2Desc");
    const perf2KpiSafety = document.getElementById("perf2KpiSafety");
    const perf2KpiOps = document.getElementById("perf2KpiOps");
    const perf2KpiProjects = document.getElementById("perf2KpiProjects");
    const perf2KpiLeadership = document.getElementById("perf2KpiLeadership");
    const perf2CreateForm = document.getElementById("perf2CreateForm");
    const perf2TableBody = document.getElementById("perf2TableBody");
    const perf2NoData = document.getElementById("perf2NoData");
    const perf2DetailPanel = document.getElementById("perf2DetailPanel");
    const perf2DetailHeader = document.getElementById("perf2DetailHeader");
    const perf2DetailId = document.getElementById("perf2DetailId");
    const perf2StageLabel = document.getElementById("perf2StageLabel");
    const perf2InitEmp = document.getElementById("perf2InitEmp");
    const perf2InitMgr = document.getElementById("perf2InitMgr");
    const perf2InitHr = document.getElementById("perf2InitHr");
    const perf2InitNote = document.getElementById("perf2InitNote");
    const perf2MidEmp = document.getElementById("perf2MidEmp");
    const perf2MidMgr = document.getElementById("perf2MidMgr");
    const perf2MidHr = document.getElementById("perf2MidHr");
    const perf2MidNote = document.getElementById("perf2MidNote");
    const perf2YearEmp = document.getElementById("perf2YearEmp");
    const perf2YearMgr = document.getElementById("perf2YearMgr");
    const perf2YearHr = document.getElementById("perf2YearHr");
    const perf2YearNote = document.getElementById("perf2YearNote");
    const perf2SummaryText = document.getElementById("perf2SummaryText");
    const btnPerf2Advance = document.getElementById("btnPerf2Advance");
    const btnPerf2Save = document.getElementById("btnPerf2Save");

    // --- TIMESHEET REFS ---
    const tsEmployee = document.getElementById("tsEmployee");
    const tsDate = document.getElementById("tsDate");
    const tsHours = document.getElementById("tsHours");
    const tsShift = document.getElementById("tsShift");
    const tsEditId = document.getElementById("tsEditId");
    const timesheetForm = document.getElementById("timesheetForm");
    const tsTableBody = document.getElementById("tsTableBody");
    const tsNoData = document.getElementById("tsNoData");
    const btnCancelTsEdit = document.getElementById("btnCancelTsEdit");
    const timesheetEmployeeFilter = document.getElementById("timesheetEmployeeFilter");

    // --- LEAVE REFS ---
    const leaveEmployee = document.getElementById("leaveEmployee");
    const leaveType = document.getElementById("leaveType");
    const leaveStart = document.getElementById("leaveStart");
    const leaveEnd = document.getElementById("leaveEnd");
    const leaveDays = document.getElementById("leaveDays");
    const leaveEngineer = document.getElementById("leaveEngineer");
    const leaveManager = document.getElementById("leaveManager");
    const leaveStatus = document.getElementById("leaveStatus");
    const leaveReason = document.getElementById("leaveReason");
    const leaveApprover = document.getElementById("leaveApprover");
    const leaveEditId = document.getElementById("leaveEditId");
    const leaveForm = document.getElementById("leaveForm");
    const leaveTableBody = document.getElementById("leaveTableBody");
    const leaveNoData = document.getElementById("leaveNoData");
    const leaveStatusFilter = document.getElementById("leaveStatusFilter");
    const btnCancelLeaveEdit = document.getElementById("btnCancelLeaveEdit");

    // --- ONBOARDING REFS ---
    const onbEmployee = document.getElementById("onbEmployee");
    const onbType = document.getElementById("onbType");
    const onbStartDate = document.getElementById("onbStartDate");
    const onbOwner = document.getElementById("onbOwner");
    const onbNotes = document.getElementById("onbNotes");
    const onbForm = document.getElementById("onbForm");
    const onbTableBody = document.getElementById("onbTableBody");
    const onbNoData = document.getElementById("onbNoData");
    const onbTypeFilter = document.getElementById("onbTypeFilter");
    const onbStatusFilter = document.getElementById("onbStatusFilter");
    const onbDetailPanel = document.getElementById("onbDetailPanel");
    const onbDetailHeader = document.getElementById("onbDetailHeader");
    const onbTasksContainer = document.getElementById("onbTasksContainer");

    // --- SETTINGS REFS ---
    const cfgCompanyName = document.getElementById("cfgCompanyName");
    const cfgDefaultDailyHours = document.getElementById("cfgDefaultDailyHours");
    const cfgPerfPeriod = document.getElementById("cfgPerfPeriod");
    const cfgDemoMode = document.getElementById("cfgDemoMode");
    const cfgPerfInitialEnd = document.getElementById("cfgPerfInitialEnd");
    const cfgPerfMidEnd = document.getElementById("cfgPerfMidEnd");
    const cfgPerfYearEnd = document.getElementById("cfgPerfYearEnd");
    const btnSaveSettings = document.getElementById("btnSaveSettings");

    // --- SIDEBAR NAV ---
    function openSidebar() {
      sidebar.classList.add("open");
      sidebarOverlay.style.display = "block";
    }

    function closeSidebar() {
      sidebar.classList.remove("open");
      sidebarOverlay.style.display = "none";
    }

    topbarMenuBtn.addEventListener("click", openSidebar);
    sidebarOverlay.addEventListener("click", closeSidebar);

    navButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const sectionId = btn.dataset.section;
        // Rol kontrol√º
        if (currentUser) {
          const allowedRoles = SECTION_PERMISSIONS[sectionId] || [];
          if (!allowedRoles.includes(currentUser.role)) {
            alert("Bu ekrana eri≈üim yetkiniz bulunmuyor.");
            return;
          }
        }
        navButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        Object.values(sections).forEach((s) => s.classList.remove("active"));
        sections[sectionId].classList.add("active");
        closeSidebar();
      });
    });

    // --- USER BADGE & ROLE UI ---
    function updateUserBadge(username) {
      const entry = LOGIN_USERS[username];
      let emp = null;
      if (entry) {
        emp = employees.find(e => e.id === entry.empId || e.username === username);
      }
      if (emp) {
        userNameLabel.textContent = emp.name;
        const dept = emp.department || "-";
        const pos = emp.position || "";
        document.querySelector(".user-meta small").textContent = (dept && pos) ? (dept + " / " + pos) : (dept || pos || "Baƒülƒ± Birim");
        const initials = emp.name.split(" ").map(p => p[0]).join("").slice(0,2).toUpperCase();
        userAvatar.textContent = initials || "US";
      } else {
        userNameLabel.textContent = username;
        userAvatar.textContent = (username[0] || "U").toUpperCase();
      }
      chipRole.textContent = "Rol: " + (entry ? entry.role : "-");
    }

    function applyRolePermissions() {
      if (!currentUser) return;
      const role = currentUser.role;

      // Nav g√∂r√ºn√ºrl√ºk
      navButtons.forEach(btn => {
        const sectionId = btn.dataset.section;
        const allowed = SECTION_PERMISSIONS[sectionId] || [];
        if (!allowed.includes(role)) {
          btn.style.display = "none";
          // Eƒüer aktif sekme ise dashboard'a d√∂n
          if (sections[sectionId].classList.contains("active")) {
            sections[sectionId].classList.remove("active");
            document.querySelector('[data-section="dashboard"]').classList.add("active");
            sections.dashboard.classList.add("active");
          }
        } else {
          btn.style.display = "flex";
        }
      });

      // Form alanlarƒ±nƒ± role g√∂re sƒ±nƒ±rlandƒ±rma (basit demo)
      // Operat√∂r: sadece izin talebi olu≈üturabilsin, kendi kayƒ±tlarƒ±nƒ± g√∂rs√ºn
      if (role === "Operat√∂r") {
        // Performans formu disable
        perfForm.querySelectorAll("input, select, button").forEach(el => el.disabled = true);
        perf2CreateForm.querySelectorAll("input, select, button").forEach(el => el.disabled = true);
        btnPerf2Save.disabled = true;
        btnPerf2Advance.disabled = true;
        timesheetForm.querySelectorAll("input, select, button").forEach(el => el.disabled = true);
      }
      // M√ºhendis: kendisi i√ßin performans formu & izin onayƒ± / olu≈üturma
      if (role === "M√ºhendis") {
        // Puantaj kayƒ±tlarƒ±nƒ± g√∂r ama deƒüi≈üiklik yetkisi sistemde a√ßƒ±k bƒ±rakƒ±labilir
      }
      // M√ºd√ºr: puantaj g√∂rs√ºn, izin onayƒ± vb. (≈üimdilik ek kƒ±sƒ±tlama yok)
      // IK: full access
    }

    // --- LOGIN LOGIC ---
    function setLoggedIn(username) {
      loginView.style.display = "none";
      appView.style.display = "block";
      updateUserBadge(username);
      applyRolePermissions();
      refreshAllUI();
      checkPerformanceReminders();
    }

    function logout() {
      appView.style.display = "none";
      loginView.style.display = "flex";
      passwordInput.value = "";
      currentUser = null;
    }

    loginBtn.addEventListener("click", (e) => {
      e.preventDefault();
      const u = usernameInput.value.trim().toLowerCase();
      const p = passwordInput.value.trim();
      const entry = LOGIN_USERS[u];

      if (entry && entry.password === p) {
        loginError.style.display = "none";
        currentUser = {
          username: u,
          role: entry.role,
          empId: entry.empId
        };
        if (rememberMe.checked) {
          saveData(STORAGE_KEYS.lastUser, { username: u });
        } else {
          localStorage.removeItem(STORAGE_KEYS.lastUser);
        }
        setLoggedIn(u);
      } else {
        loginError.style.display = "block";
      }
    });

    document.getElementById("logoutBtn").addEventListener("click", () => {
      logout();
    });

    // --- DASHBOARD METRICS ---
    function refreshMetrics() {
      const activeEmployees = employees.filter(e => e.status !== "Pasif");
      metricTotalEmployees.textContent = activeEmployees.length;
      metricEmployeesDetail.textContent = activeEmployees.length
        ? activeEmployees.map(e => e.department || "Genel").reduce((acc, d) => {
            acc[d] = (acc[d] || 0) + 1;
            return acc;
          }, {})
        : "";

      if (typeof metricEmployeesDetail.textContent === "object") {
        // stringe √ßevirelim
        const obj = activeEmployees.map(e => e.department || "Genel").reduce((acc, d) => {
          acc[d] = (acc[d] || 0) + 1;
          return acc;
        }, {});
        metricEmployeesDetail.textContent = Object.entries(obj).map(([k,v]) => `${k}: ${v}`).join(" ‚Ä¢ ");
      }

      metricActiveReviews.textContent = perfForms.length;

      // Bug√ºnk√º puantaj
      const todayStr = new Date().toISOString().slice(0,10);
      const todayTs = timesheets.filter(t => t.date === todayStr);
      const totalHours = todayTs.reduce((sum, t) => sum + (Number(t.hours) || 0), 0);
      metricTodayHours.textContent = totalHours.toString() + " sa";
      if (todayTs.length) {
        metricTodayDetail.textContent = todayTs.length + " kayƒ±t";
      } else {
        metricTodayDetail.textContent = "Bug√ºne ait kayƒ±t yok.";
      }

      // Bekleyen izin sayƒ±sƒ±
      const pending = leaves.filter(l => l.status === "Bekliyor");
      metricPendingLeaves.textContent = pending.length;
    }

    // --- EMPLOYEES UI ---
    function resetEmployeeForm() {
      empName.value = "";
      empDepartment.value = "";
      empPosition.value = "";
      empStatus.value = "Aktif";
      empEngineer.value = "";
      empManager.value = "";
      empHrOwner.value = "";
      empRole.value = "";
      empEditId.value = "";
    }

    function renderEmployees() {
      const search = employeeSearch.value.trim().toLowerCase();
      const statusFilter = employeeFilterStatus.value;
      let list = [...employees];

      if (search) {
        list = list.filter(e =>
          (e.name || "").toLowerCase().includes(search) ||
          (e.department || "").toLowerCase().includes(search)
        );
      }
      if (statusFilter) {
        list = list.filter(e => e.status === statusFilter);
      }

      employeeTableBody.innerHTML = "";
      if (!list.length) {
        employeeNoData.style.display = "block";
        return;
      }
      employeeNoData.style.display = "none";

      list.forEach(emp => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp.name || ""}</td>
          <td>${emp.department || ""}</td>
          <td>${emp.position || ""}</td>
          <td>${emp.status || ""}</td>
          <td>${emp.reportingEngineer || ""}</td>
          <td>${emp.reportingManager || ""}</td>
          <td>${emp.hrOwner || ""}</td>
          <td>${emp.role || ""}</td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="edit" data-id="${emp.id}">D√ºzenle</button>
              <button class="btn-sm" data-action="delete" data-id="${emp.id}">Sil</button>
            </div>
          </td>
        `;
        employeeTableBody.appendChild(tr);
      });
    }

    employeeForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = empEditId.value || ("EMP" + Date.now());
      const isEdit = !!empEditId.value;

      const payload = {
        id,
        name: empName.value.trim(),
        department: empDepartment.value.trim(),
        position: empPosition.value.trim(),
        status: empStatus.value,
        reportingEngineer: empEngineer.value.trim(),
        reportingManager: empManager.value.trim(),
        hrOwner: empHrOwner.value.trim(),
        role: empRole.value || "",
        username: (empName.value ? empName.value.toLowerCase().replace(/≈ü/g,"s").replace(/ƒ±/g,"i").replace(/√∂/g,"o").replace(/√º/g,"u").replace(/√ß/g,"c").replace(/ƒü/g,"g").replace(/\s+/g,".") : "")
      };

      if (isEdit) {
        const idx = employees.findIndex(e => e.id === id);
        if (idx >= 0) employees[idx] = payload;
      } else {
        employees.push(payload);
      }

      saveData(STORAGE_KEYS.employees, employees);
      resetEmployeeForm();
      renderEmployees();
      refreshSelectOptions();
      refreshMetrics();
    });

    employeeTableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const emp = employees.find(e => e.id === id);
      if (!emp) return;

      if (action === "edit") {
        empEditId.value = emp.id;
        empName.value = emp.name || "";
        empDepartment.value = emp.department || "";
        empPosition.value = emp.position || "";
        empStatus.value = emp.status || "Aktif";
        empEngineer.value = emp.reportingEngineer || "";
        empManager.value = emp.reportingManager || "";
        empHrOwner.value = emp.hrOwner || "";
        empRole.value = emp.role || "";
      } else if (action === "delete") {
        if (confirm("Bu personeli silmek istediƒüinize emin misiniz?")) {
          employees = employees.filter(e => e.id !== id);
          saveData(STORAGE_KEYS.employees, employees);
          renderEmployees();
          refreshSelectOptions();
          refreshMetrics();
        }
      }
    });

    btnCancelEmployeeEdit.addEventListener("click", () => {
      resetEmployeeForm();
    });

    employeeSearch.addEventListener("input", renderEmployees);
    employeeFilterStatus.addEventListener("change", renderEmployees);
    btnAddEmployee.addEventListener("click", () => {
      resetEmployeeForm();
    });

    // --- PERFORMANCE (BASIT) ---
    function resetPerfForm() {
      perfEmployee.value = "";
      perfPeriodInput.value = "";
      perfScore.value = "";
      perfComment.value = "";
      perfEditId.value = "";
    }

    function renderPerf() {
      perfTableBody.innerHTML = "";
      if (!performance.length) {
        perfNoData.style.display = "block";
        return;
      }
      perfNoData.style.display = "none";

      performance.forEach(p => {
        const emp = employees.find(e => e.id === p.empId);
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp ? emp.name : "-"}</td>
          <td>${p.period || ""}</td>
          <td>${p.score ?? ""}</td>
          <td>${p.comment || ""}</td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="edit" data-id="${p.id}">D√ºzenle</button>
              <button class="btn-sm" data-action="delete" data-id="${p.id}">Sil</button>
            </div>
          </td>
        `;
        perfTableBody.appendChild(tr);
      });
    }

    perfForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = perfEditId.value || ("PERF" + Date.now());
      const isEdit = !!perfEditId.value;
      const empId = perfEmployee.value;

      const payload = {
        id,
        empId,
        period: perfPeriodInput.value.trim() || "Genel",
        score: Number(perfScore.value || 0),
        comment: perfComment.value.trim()
      };

      if (isEdit) {
        const idx = performance.findIndex(p => p.id === id);
        if (idx >= 0) performance[idx] = payload;
      } else {
        performance.push(payload);
      }

      saveData(STORAGE_KEYS.performance, performance);
      resetPerfForm();
      renderPerf();
      refreshMetrics();
    });

    perfTableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const row = performance.find(p => p.id === id);
      if (!row) return;

      if (action === "edit") {
        perfEditId.value = row.id;
        perfEmployee.value = row.empId;
        perfPeriodInput.value = row.period;
        perfScore.value = row.score;
        perfComment.value = row.comment;
      } else if (action === "delete") {
        if (confirm("Bu performans kaydƒ±nƒ± silmek istediƒüinize emin misiniz?")) {
          performance = performance.filter(p => p.id !== id);
          saveData(STORAGE_KEYS.performance, performance);
          renderPerf();
          refreshMetrics();
        }
      }
    });

    btnCancelPerfEdit.addEventListener("click", () => {
      resetPerfForm();
    });

    // --- PERFORMANCE FORMS (M√úHENDƒ∞SLƒ∞K) ---
    function resetPerf2Detail() {
      perf2InitEmp.value = "";
      perf2InitMgr.value = "";
      perf2InitHr.value = "";
      perf2InitNote.value = "";
      perf2MidEmp.value = "";
      perf2MidMgr.value = "";
      perf2MidHr.value = "";
      perf2MidNote.value = "";
      perf2YearEmp.value = "";
      perf2YearMgr.value = "";
      perf2YearHr.value = "";
      perf2YearNote.value = "";
      perf2DetailId.value = "";
      perf2SummaryText.textContent = "";
      perf2StageLabel.textContent = "";
    }

    function calcPerfFormAverages(form) {
      const mid = [];
      const year = [];

      if (form.midEmp != null) mid.push(Number(form.midEmp));
      if (form.midMgr != null) mid.push(Number(form.midMgr));
      if (form.midHr != null) mid.push(Number(form.midHr));

      if (form.yearEmp != null) year.push(Number(form.yearEmp));
      if (form.yearMgr != null) year.push(Number(form.yearMgr));
      if (form.yearHr != null) year.push(Number(form.yearHr));

      const midAvg = mid.length ? mid.reduce((a,b)=>a+b,0)/mid.length : null;
      const yearAvg = year.length ? year.reduce((a,b)=>a+b,0)/year.length : null;

      let finalScore = null;
      if (midAvg != null && yearAvg != null) {
        finalScore = (midAvg + yearAvg) / 2;
      } else if (yearAvg != null) {
        finalScore = yearAvg;
      } else if (midAvg != null) {
        finalScore = midAvg;
      }

      return { midAvg, yearAvg, finalScore };
    }

    function renderPerf2Table() {
      perf2TableBody.innerHTML = "";
      if (!perfForms.length) {
        perf2NoData.style.display = "block";
        return;
      }
      perf2NoData.style.display = "none";

      perfForms.forEach(form => {
        const emp = employees.find(e => e.id === form.empId);
        const { midAvg, yearAvg, finalScore } = calcPerfFormAverages(form);
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp ? emp.name : "-"}</td>
          <td>${form.year || ""}</td>
          <td>${form.role || ""}</td>
          <td>${form.stage || "ƒ∞lk Form"}</td>
          <td>${midAvg != null ? midAvg.toFixed(1) : "-"}</td>
          <td>${yearAvg != null ? yearAvg.toFixed(1) : "-"}</td>
          <td>${finalScore != null ? finalScore.toFixed(1) : "-"}</td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="detail" data-id="${form.id}">Detay</button>
              <button class="btn-sm" data-action="delete" data-id="${form.id}">Sil</button>
            </div>
          </td>
        `;
        perf2TableBody.appendChild(tr);
      });
    }

    perf2CreateForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const empId = perf2Employee.value;
      if (!empId) {
        alert("L√ºtfen personel se√ßin.");
        return;
      }

      const id = "PFORM" + Date.now();
      const form = {
        id,
        empId,
        year: Number(perf2Year.value || new Date().getFullYear()),
        role: perf2Role.value.trim(),
        desc: perf2Desc.value.trim(),
        kpiSafety: perf2KpiSafety.value.trim(),
        kpiOps: perf2KpiOps.value.trim(),
        kpiProjects: perf2KpiProjects.value.trim(),
        kpiLeadership: perf2KpiLeadership.value.trim(),
        stage: "ƒ∞lk Form",
        // ƒ∞lk
        initEmp: null,
        initMgr: null,
        initHr: null,
        initNote: "",
        // Ara
        midEmp: null,
        midMgr: null,
        midHr: null,
        midNote: "",
        // Yƒ±l sonu
        yearEmp: null,
        yearMgr: null,
        yearHr: null,
        yearNote: ""
      };

      perfForms.push(form);
      saveData(STORAGE_KEYS.perfForms, perfForms);
      renderPerf2Table();
      refreshMetrics();
      alert("Performans formu olu≈üturuldu.");
    });

    perf2TableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const form = perfForms.find(f => f.id === id);
      if (!form) return;

      if (action === "detail") {
        perf2DetailPanel.style.display = "block";
        perf2DetailId.value = form.id;
        const emp = employees.find(e => e.id === form.empId);
        perf2DetailHeader.textContent = `${emp ? emp.name : "-"} ‚Ä¢ ${form.year} ‚Ä¢ ${form.role || ""}`;
        perf2StageLabel.textContent = form.stage || "ƒ∞lk Form";

        perf2InitEmp.value = form.initEmp ?? "";
        perf2InitMgr.value = form.initMgr ?? "";
        perf2InitHr.value = form.initHr ?? "";
        perf2InitNote.value = form.initNote || "";
        perf2MidEmp.value = form.midEmp ?? "";
        perf2MidMgr.value = form.midMgr ?? "";
        perf2MidHr.value = form.midHr ?? "";
        perf2MidNote.value = form.midNote || "";
        perf2YearEmp.value = form.yearEmp ?? "";
        perf2YearMgr.value = form.yearMgr ?? "";
        perf2YearHr.value = form.yearHr ?? "";
        perf2YearNote.value = form.yearNote || "";

        const { midAvg, yearAvg, finalScore } = calcPerfFormAverages(form);
        perf2SummaryText.textContent =
          `Ara Ort.: ${midAvg != null ? midAvg.toFixed(1) : "-"} ‚Ä¢ ` +
          `Yƒ±l Sonu Ort.: ${yearAvg != null ? yearAvg.toFixed(1) : "-"} ‚Ä¢ ` +
          `Final: ${finalScore != null ? finalScore.toFixed(1) : "-"}`;
      } else if (action === "delete") {
        if (confirm("Bu performans formunu silmek istediƒüinize emin misiniz?")) {
          perfForms = perfForms.filter(f => f.id !== id);
          saveData(STORAGE_KEYS.perfForms, perfForms);
          renderPerf2Table();
          refreshMetrics();
          if (perf2DetailId.value === id) {
            perf2DetailPanel.style.display = "none";
            resetPerf2Detail();
          }
        }
      }
    });

    // Form detayƒ±nƒ± kaydet
    btnPerf2Save.addEventListener("click", () => {
      const id = perf2DetailId.value;
      if (!id) return;
      const form = perfForms.find(f => f.id === id);
      if (!form) return;

      form.initEmp = perf2InitEmp.value !== "" ? Number(perf2InitEmp.value) : null;
      form.initMgr = perf2InitMgr.value !== "" ? Number(perf2InitMgr.value) : null;
      form.initHr = perf2InitHr.value !== "" ? Number(perf2InitHr.value) : null;
      form.initNote = perf2InitNote.value.trim();

      form.midEmp = perf2MidEmp.value !== "" ? Number(perf2MidEmp.value) : null;
      form.midMgr = perf2MidMgr.value !== "" ? Number(perf2MidMgr.value) : null;
      form.midHr = perf2MidHr.value !== "" ? Number(perf2MidHr.value) : null;
      form.midNote = perf2MidNote.value.trim();

      form.yearEmp = perf2YearEmp.value !== "" ? Number(perf2YearEmp.value) : null;
      form.yearMgr = perf2YearMgr.value !== "" ? Number(perf2YearMgr.value) : null;
      form.yearHr = perf2YearHr.value !== "" ? Number(perf2YearHr.value) : null;
      form.yearNote = perf2YearNote.value.trim();

      const { midAvg, yearAvg, finalScore } = calcPerfFormAverages(form);
      perf2SummaryText.textContent =
        `Ara Ort.: ${midAvg != null ? midAvg.toFixed(1) : "-"} ‚Ä¢ ` +
        `Yƒ±l Sonu Ort.: ${yearAvg != null ? yearAvg.toFixed(1) : "-"} ‚Ä¢ ` +
        `Final: ${finalScore != null ? finalScore.toFixed(1) : "-"}`;

      saveData(STORAGE_KEYS.perfForms, perfForms);
      renderPerf2Table();
      refreshMetrics();
      alert("Performans formu kaydedildi (demo).");
    });

    // A≈üamayƒ± ilerlet (demo)
    btnPerf2Advance.addEventListener("click", () => {
      const id = perf2DetailId.value;
      if (!id) return;
      const form = perfForms.find(f => f.id === id);
      if (!form) return;

      const stages = ["ƒ∞lk Form", "Ara Deƒüerlendirme", "Yƒ±l Sonu", "Tamamlandƒ±"];
      const idx = stages.indexOf(form.stage || "ƒ∞lk Form");
      const nextStage = stages[Math.min(idx + 1, stages.length - 1)];
      form.stage = nextStage;
      perf2StageLabel.textContent = form.stage;
      saveData(STORAGE_KEYS.perfForms, perfForms);
      renderPerf2Table();
      alert("A≈üama g√ºncellendi: " + nextStage);
    });

    // --- TIMESHEET (PUANTAJ) ---
    const timesheetMonth = document.getElementById("timesheetMonth");
    const btnAddTimesheet = document.getElementById("btnAddTimesheet");

    function resetTimesheetForm() {
      tsEmployee.value = "";
      tsDate.value = "";
      tsHours.value = "";
      tsShift.value = "";
      tsEditId.value = "";
    }

    function renderTimesheets() {
      let list = [...timesheets];
      const empFilter = timesheetEmployeeFilter.value;
      const monthFilter = timesheetMonth.value; // yyyy-mm

      if (empFilter) {
        list = list.filter(t => t.empId === empFilter);
      }
      if (monthFilter) {
        list = list.filter(t => (t.date || "").slice(0, 7) === monthFilter);
      }

      // Tarihe g√∂re sƒ±ralama (yeniden eskiye)
      list.sort((a, b) => (b.date || "").localeCompare(a.date || ""));

      tsTableBody.innerHTML = "";
      if (!list.length) {
        tsNoData.style.display = "block";
        return;
      }
      tsNoData.style.display = "none";

      list.forEach(t => {
        const emp = employees.find(e => e.id === t.empId);
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp ? emp.name : "-"}</td>
          <td>${t.date || ""}</td>
          <td>${t.hours ?? ""}</td>
          <td>${t.shift || ""}</td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="edit" data-id="${t.id}">D√ºzenle</button>
              <button class="btn-sm" data-action="delete" data-id="${t.id}">Sil</button>
            </div>
          </td>
        `;
        tsTableBody.appendChild(tr);
      });
    }

    timesheetForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = tsEditId.value || ("TS" + Date.now());
      const isEdit = !!tsEditId.value;

      const payload = {
        id,
        empId: tsEmployee.value,
        date: tsDate.value,
        hours: Number(tsHours.value || 0),
        shift: tsShift.value.trim()
      };

      if (!payload.empId || !payload.date) {
        alert("L√ºtfen personel ve tarih se√ßin.");
        return;
      }

      if (isEdit) {
        const idx = timesheets.findIndex(t => t.id === id);
        if (idx >= 0) timesheets[idx] = payload;
      } else {
        timesheets.push(payload);
      }

      saveData(STORAGE_KEYS.timesheets, timesheets);
      resetTimesheetForm();
      renderTimesheets();
      refreshMetrics();
    });

    tsTableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const row = timesheets.find(t => t.id === id);
      if (!row) return;

      if (action === "edit") {
        tsEditId.value = row.id;
        tsEmployee.value = row.empId;
        tsDate.value = row.date;
        tsHours.value = row.hours;
        tsShift.value = row.shift || "";
      } else if (action === "delete") {
        if (confirm("Bu puantaj kaydƒ±nƒ± silmek istediƒüinize emin misiniz?")) {
          timesheets = timesheets.filter(t => t.id !== id);
          saveData(STORAGE_KEYS.timesheets, timesheets);
          renderTimesheets();
          refreshMetrics();
        }
      }
    });

    btnCancelTsEdit.addEventListener("click", () => {
      resetTimesheetForm();
    });

    timesheetEmployeeFilter.addEventListener("change", renderTimesheets);
    if (timesheetMonth) {
      timesheetMonth.addEventListener("change", renderTimesheets);
    }
    btnAddTimesheet.addEventListener("click", () => {
      resetTimesheetForm();
    });

    // --- LEAVE (ƒ∞Zƒ∞N) ---
    const btnAddLeave = document.getElementById("btnAddLeave");

    function resetLeaveForm() {
      leaveEmployee.value = "";
      leaveType.value = "Yƒ±llƒ±k ƒ∞zin";
      leaveStart.value = "";
      leaveEnd.value = "";
      leaveDays.value = "";
      leaveEngineer.value = "";
      leaveManager.value = "";
      leaveStatus.value = "Bekliyor";
      leaveReason.value = "";
      leaveApprover.value = "";
      leaveEditId.value = "";
    }

    function renderLeaves() {
      let list = [...leaves];
      const status = leaveStatusFilter.value;
      if (status) {
        list = list.filter(l => l.status === status);
      }

      leaveTableBody.innerHTML = "";
      if (!list.length) {
        leaveNoData.style.display = "block";
        return;
      }
      leaveNoData.style.display = "none";

      list.forEach(l => {
        const emp = employees.find(e => e.id === l.empId);
        const chain = [l.engineer, l.manager].filter(Boolean).join(" ‚Üí ") || "-";
        const badgeClass =
          l.status === "Onaylandƒ±"
            ? "badge badge-success"
            : l.status === "Reddedildi"
              ? "badge badge-danger"
              : "badge badge-warning";

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp ? emp.name : "-"}</td>
          <td>${l.type || ""}</td>
          <td>${l.start || ""}</td>
          <td>${l.end || ""}</td>
          <td>${l.days ?? ""}</td>
          <td>${chain}</td>
          <td><span class="${badgeClass}">${l.status}</span></td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="edit" data-id="${l.id}">D√ºzenle</button>
              <button class="btn-sm" data-action="delete" data-id="${l.id}">Sil</button>
            </div>
          </td>
        `;
        leaveTableBody.appendChild(tr);
      });
    }

    // Ba≈ülangƒ±√ß / biti≈ü deƒüi≈üince g√ºn sayƒ±sƒ±nƒ± basit√ße hesapla (haftasonu hesabƒ± yok, demo)
    function autoCalcLeaveDays() {
      if (!leaveStart.value || !leaveEnd.value) return;
      const start = new Date(leaveStart.value);
      const end = new Date(leaveEnd.value);
      if (isNaN(start) || isNaN(end) || end < start) return;
      const diffMs = end.getTime() - start.getTime();
      const diffDays = diffMs / (1000 * 60 * 60 * 24) + 1;
      leaveDays.value = diffDays;
    }

    leaveStart.addEventListener("change", autoCalcLeaveDays);
    leaveEnd.addEventListener("change", autoCalcLeaveDays);

    leaveForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = leaveEditId.value || ("LV" + Date.now());
      const isEdit = !!leaveEditId.value;

      const payload = {
        id,
        empId: leaveEmployee.value,
        type: leaveType.value,
        start: leaveStart.value,
        end: leaveEnd.value,
        days: Number(leaveDays.value || 0),
        engineer: leaveEngineer.value.trim(),
        manager: leaveManager.value.trim(),
        status: leaveStatus.value,
        reason: leaveReason.value.trim(),
        approverNote: leaveApprover.value.trim()
      };

      if (!payload.empId || !payload.start || !payload.end) {
        alert("L√ºtfen personel, ba≈ülangƒ±√ß ve biti≈ü tarihlerini girin.");
        return;
      }

      if (isEdit) {
        const idx = leaves.findIndex(l => l.id === id);
        if (idx >= 0) leaves[idx] = payload;
      } else {
        leaves.push(payload);
      }

      saveData(STORAGE_KEYS.leaves, leaves);
      resetLeaveForm();
      renderLeaves();
      refreshMetrics();
    });

    leaveTableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const row = leaves.find(l => l.id === id);
      if (!row) return;

      if (action === "edit") {
        leaveEditId.value = row.id;
        leaveEmployee.value = row.empId;
        leaveType.value = row.type || "Yƒ±llƒ±k ƒ∞zin";
        leaveStart.value = row.start || "";
        leaveEnd.value = row.end || "";
        leaveDays.value = row.days ?? "";
        leaveEngineer.value = row.engineer || "";
        leaveManager.value = row.manager || "";
        leaveStatus.value = row.status || "Bekliyor";
        leaveReason.value = row.reason || "";
        leaveApprover.value = row.approverNote || "";
      } else if (action === "delete") {
        if (confirm("Bu izin talebini silmek istediƒüinize emin misiniz?")) {
          leaves = leaves.filter(l => l.id !== id);
          saveData(STORAGE_KEYS.leaves, leaves);
          renderLeaves();
          refreshMetrics();
        }
      }
    });

    btnCancelLeaveEdit.addEventListener("click", () => {
      resetLeaveForm();
    });

    leaveStatusFilter.addEventListener("change", renderLeaves);
    btnAddLeave.addEventListener("click", () => {
      resetLeaveForm();
    });

    // --- ONBOARDING / OFFBOARDING ---
    function buildOnbTasks(type) {
      if (type === "Offboarding") {
        return [
          { key: "equip_return", label: "Zimmetli ekipman iade edildi", done: false },
          { key: "access_disable", label: "T√ºm sistem eri≈üimleri kapatƒ±ldƒ±", done: false },
          { key: "exit_interview", label: "Exit interview ger√ßekle≈ütirildi", done: false },
          { key: "payroll_close", label: "Bordro & hakedi≈ü kontrolleri yapƒ±ldƒ±", done: false }
        ];
      }
      // Onboarding
      return [
        { key: "contract", label: "ƒ∞≈ü s√∂zle≈ümesi imzalatƒ±ldƒ±", done: false },
        { key: "orientation", label: "Oryantasyon planƒ± tamamlandƒ±", done: false },
        { key: "hsse_training", label: "HSSE / ƒ∞≈ü G√ºvenliƒüi eƒüitimleri verildi", done: false },
        { key: "access", label: "Sistem ve saha eri≈üimleri tanƒ±mlandƒ±", done: false }
      ];
    }

    function renderOnboarding() {
      let list = [...onboarding];
      const typeF = onbTypeFilter.value;
      const statusF = onbStatusFilter.value;

      if (typeF) list = list.filter(o => o.type === typeF);
      if (statusF) list = list.filter(o => o.status === statusF);

      onbTableBody.innerHTML = "";
      if (!list.length) {
        onbNoData.style.display = "block";
        onbDetailPanel.style.display = "none";
        return;
      }
      onbNoData.style.display = "none";

      list.forEach(o => {
        const emp = employees.find(e => e.id === o.empId);
        const tasks = o.tasks || [];
        const doneCount = tasks.filter(t => t.done).length;
        const total = tasks.length || 1;
        const ratio = `${doneCount}/${total}`;
        const badgeClass =
          o.status === "Tamamlandƒ±" ? "badge badge-success" : "badge badge-warning";

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${emp ? emp.name : "-"}</td>
          <td>${o.type}</td>
          <td>${o.startDate || ""}</td>
          <td>${ratio} g√∂rev tamamlandƒ±</td>
          <td><span class="${badgeClass}">${o.status}</span></td>
          <td>
            <div class="table-actions">
              <button class="btn-sm" data-action="detail" data-id="${o.id}">Detay</button>
              <button class="btn-sm" data-action="delete" data-id="${o.id}">Sil</button>
            </div>
          </td>
        `;
        onbTableBody.appendChild(tr);
      });
    }

    onbForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const empId = onbEmployee.value;
      if (!empId) {
        alert("L√ºtfen personel se√ßin.");
        return;
      }
      const id = "ONB" + Date.now();
      const type = onbType.value || "Onboarding";
      const record = {
        id,
        empId,
        type,
        startDate: onbStartDate.value,
        owner: onbOwner.value.trim(),
        notes: onbNotes.value.trim(),
        status: "Devam Ediyor",
        tasks: buildOnbTasks(type)
      };
      onboarding.push(record);
      saveData(STORAGE_KEYS.onboarding, onboarding);
      onbForm.reset();
      renderOnboarding();
    });

    onbTableBody.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;
      const rec = onboarding.find(o => o.id === id);
      if (!rec) return;

      if (action === "detail") {
        const emp = employees.find(e => e.id === rec.empId);
        onbDetailPanel.style.display = "block";
        onbDetailHeader.textContent =
          `${emp ? emp.name : "-"} ‚Ä¢ ${rec.type} ‚Ä¢ ${rec.startDate || ""} ‚Ä¢ Sorumlu: ${rec.owner || "-"}`;

        // Checklist render
        onbTasksContainer.innerHTML = "";
        (rec.tasks || []).forEach((t, index) => {
          const div = document.createElement("div");
          div.className = "checklist-item";
          div.innerHTML = `
            <input type="checkbox" data-onb-id="${rec.id}" data-index="${index}" ${t.done ? "checked" : ""} />
            <span>${t.label}</span>
          `;
          onbTasksContainer.appendChild(div);
        });

        // Checkbox change handler (delegation)
        onbTasksContainer.querySelectorAll("input[type='checkbox']").forEach(chk => {
          chk.addEventListener("change", (ev) => {
            const idx = Number(ev.target.dataset.index);
            const rid = ev.target.dataset.onbId;
            const r = onboarding.find(o => o.id === rid);
            if (!r || !r.tasks || !r.tasks[idx]) return;
            r.tasks[idx].done = ev.target.checked;

            // T√ºm g√∂revler bittiyse s√ºreci tamamlandƒ± yap
            const allDone = r.tasks.length && r.tasks.every(t => t.done);
            r.status = allDone ? "Tamamlandƒ±" : "Devam Ediyor";
            saveData(STORAGE_KEYS.onboarding, onboarding);
            renderOnboarding();
          });
        });
      } else if (action === "delete") {
        if (confirm("Bu onboarding/offboarding s√ºrecini silmek istediƒüinize emin misiniz?")) {
          onboarding = onboarding.filter(o => o.id !== id);
          saveData(STORAGE_KEYS.onboarding, onboarding);
          renderOnboarding();
        }
      }
    });

    onbTypeFilter.addEventListener("change", renderOnboarding);
    onbStatusFilter.addEventListener("change", renderOnboarding);

    // --- REPORTS (Mock) ---
    const btnExportDummy = document.getElementById("btnExportDummy");
    const reportType = document.getElementById("reportType");

    btnExportDummy.addEventListener("click", () => {
      const type = reportType.value;
      console.log("[EXPORT MOCK] Rapor tipi:", type);
      alert("Demo: '" + type + "' raporu i√ßin Excel/PDF dƒ±≈üa aktarƒ±m backend ile entegre edilebilir.");
    });

    // --- SETTINGS ---
    function loadSettingsToForm() {
      cfgCompanyName.value = settings.companyName || "";
      cfgDefaultDailyHours.value = settings.defaultDailyHours ?? "";
      cfgPerfPeriod.value = settings.perfPeriod || "";
      cfgDemoMode.value = settings.demoMode || "on";
      if (settings.performancePeriods) {
        cfgPerfInitialEnd.value = settings.performancePeriods.initialEnd || "";
        cfgPerfMidEnd.value = settings.performancePeriods.midEnd || "";
        cfgPerfYearEnd.value = settings.performancePeriods.yearEnd || "";
      }
    }

    btnSaveSettings.addEventListener("click", () => {
      settings.companyName = cfgCompanyName.value.trim() || "HR Suite Demo";
      settings.defaultDailyHours = Number(cfgDefaultDailyHours.value || 8);
      settings.perfPeriod = cfgPerfPeriod.value.trim() || "2025";
      settings.demoMode = cfgDemoMode.value || "on";
      settings.performancePeriods = {
        initialEnd: cfgPerfInitialEnd.value || "",
        midEnd: cfgPerfMidEnd.value || "",
        yearEnd: cfgPerfYearEnd.value || ""
      };
      saveData(STORAGE_KEYS.settings, settings);
      alert("Ayarlar kaydedildi (localStorage).");
    });

    // --- DASHBOARD D√ñNEM SE√áƒ∞Mƒ∞ (Mock) ---
    const dashboardPeriod = document.getElementById("dashboardPeriod");
    const btnRefreshDashboard = document.getElementById("btnRefreshDashboard");

    btnRefreshDashboard.addEventListener("click", () => {
      console.log("[DASHBOARD] D√∂nem:", dashboardPeriod.value);
      refreshMetrics();
      alert("Dashboard verileri g√ºncellendi (demo).");
    });

    // --- SELECT ALANLARINI PERSONELLERLE DOLDUR ---
    function refreshSelectOptions() {
      const empSelects = [perfEmployee, perf2Employee, tsEmployee, timesheetEmployeeFilter, leaveEmployee, onbEmployee];
      empSelects.forEach(sel => {
        if (!sel) return;
        const current = sel.value;
        sel.innerHTML = "";
        // Filtre select'leri i√ßin bo≈ü se√ßenek
        if (sel === timesheetEmployeeFilter) {
          const opt = document.createElement("option");
          opt.value = "";
          opt.textContent = "T√ºm Personeller";
          sel.appendChild(opt);
        }
        const activeEmployees = employees.filter(e => e.status !== "Pasif");
        activeEmployees.forEach(e => {
          const opt = document.createElement("option");
          opt.value = e.id;
          opt.textContent = e.name;
          sel.appendChild(opt);
        });
        // Eski se√ßim h√¢l√¢ ge√ßerliyse koru
        if ([...sel.options].some(o => o.value === current)) {
          sel.value = current;
        }
      });
    }

    // --- PERFORMANS HATIRLATICILARI (DEMO) ---
    function checkPerformanceReminders() {
      if (!currentUser || settings.demoMode !== "on") return;

      const today = new Date().toISOString().slice(0, 10);
      const periods = settings.performancePeriods || {};
      const msgs = [];

      if (periods.initialEnd && today === periods.initialEnd) {
        msgs.push("Bug√ºn ilk performans formlarƒ±nƒ±n son g√ºn√º.");
      }
      if (periods.midEnd && today === periods.midEnd) {
        msgs.push("Bug√ºn ara d√∂nem deƒüerlendirmelerinin son g√ºn√º.");
      }
      if (periods.yearEnd && today === periods.yearEnd) {
        msgs.push("Bug√ºn yƒ±l sonu deƒüerlendirmelerinin son g√ºn√º.");
      }

      if (msgs.length && ["M√ºd√ºr", "IK"].includes(currentUser.role)) {
        alert(msgs.join("\n"));
      }
    }

    // --- GENEL UI YENƒ∞LEME ---
    function refreshAllUI() {
      refreshSelectOptions();
      renderEmployees();
      renderPerf();
      renderPerf2Table();
      renderTimesheets();
      renderLeaves();
      renderOnboarding();
      refreshMetrics();
      loadSettingsToForm();
    }

    // ƒ∞lk y√ºklemede sadece ayarlarƒ±, tablolarƒ± ve metrikleri √ßiz
    refreshAllUI();
  </script>
</body>
</html>
